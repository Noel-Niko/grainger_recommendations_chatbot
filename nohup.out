/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [11904]
INFO:     Waiting for application startup.
2024-07-12 17:26:04,534 - INFO - Getting bedrock client...
2024-07-12 17:26:04,539 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 17:26:04,793 - INFO - Initializing Bedrock...
2024-07-12 17:26:04,801 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 17:26:05,046 - INFO - Initializing Titan Embeddings Model...
2024-07-12 17:26:05,046 - INFO - Titan Embeddings Model initialized.
2024-07-12 17:26:05,046 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 17:26:05,082 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 17:26:05,082 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 17:26:05,093 - INFO - Documents file loaded successfully!
2024-07-12 17:26:05,093 - INFO - Structured documents created:
2024-07-12 17:26:05,093 - INFO - Document 1 of 3993:
2024-07-12 17:26:05,093 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 17:26:05,093 - INFO - Document 2 of 3993:
2024-07-12 17:26:05,093 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 17:26:05,093 - INFO - Document 3 of 3993:
2024-07-12 17:26:05,093 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 17:26:05,093 - INFO - Document 4 of 3993:
2024-07-12 17:26:05,093 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 17:26:05,093 - INFO - Document 5 of 3993:
2024-07-12 17:26:05,093 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 17:26:05,098 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 17:26:05,098 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 17:26:05,102 - INFO - Loading faiss.
2024-07-12 17:26:05,159 - INFO - Successfully loaded faiss.
2024-07-12 17:26:05,175 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 17:26:05,177 - INFO - ====== WebDriver manager ======
2024-07-12 17:26:05,390 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:26:05,441 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:26:05,495 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8503
  Network URL: http://10.52.150.95:8503

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [12214]
INFO:     Waiting for application startup.
2024-07-12 17:31:35,595 - INFO - Getting bedrock client...
2024-07-12 17:31:35,599 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 17:31:35,871 - INFO - Initializing Bedrock...
2024-07-12 17:31:35,879 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 17:31:36,121 - INFO - Initializing Titan Embeddings Model...
2024-07-12 17:31:36,122 - INFO - Titan Embeddings Model initialized.
2024-07-12 17:31:36,122 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 17:31:36,157 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 17:31:36,157 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 17:31:36,166 - INFO - Documents file loaded successfully!
2024-07-12 17:31:36,166 - INFO - Structured documents created:
2024-07-12 17:31:36,166 - INFO - Document 1 of 3993:
2024-07-12 17:31:36,166 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 17:31:36,166 - INFO - Document 2 of 3993:
2024-07-12 17:31:36,166 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 17:31:36,166 - INFO - Document 3 of 3993:
2024-07-12 17:31:36,166 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 17:31:36,166 - INFO - Document 4 of 3993:
2024-07-12 17:31:36,166 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 17:31:36,166 - INFO - Document 5 of 3993:
2024-07-12 17:31:36,166 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 17:31:36,171 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 17:31:36,171 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 17:31:36,176 - INFO - Loading faiss.
2024-07-12 17:31:36,237 - INFO - Successfully loaded faiss.
2024-07-12 17:31:36,253 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 17:31:36,255 - INFO - ====== WebDriver manager ======
2024-07-12 17:31:36,451 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:31:36,500 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:31:36,548 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
INFO:     Application startup complete.
ERROR:    [Errno 48] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [12526]
INFO:     Waiting for application startup.
2024-07-12 17:39:55,396 - INFO - Getting bedrock client...
2024-07-12 17:39:55,400 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 17:39:55,643 - INFO - Initializing Bedrock...
2024-07-12 17:39:55,650 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 17:39:55,890 - INFO - Initializing Titan Embeddings Model...
2024-07-12 17:39:55,890 - INFO - Titan Embeddings Model initialized.
2024-07-12 17:39:55,890 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 17:39:55,925 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 17:39:55,925 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 17:39:55,934 - INFO - Documents file loaded successfully!
2024-07-12 17:39:55,934 - INFO - Structured documents created:
2024-07-12 17:39:55,934 - INFO - Document 1 of 3993:
2024-07-12 17:39:55,934 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 17:39:55,934 - INFO - Document 2 of 3993:
2024-07-12 17:39:55,934 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 17:39:55,934 - INFO - Document 3 of 3993:
2024-07-12 17:39:55,934 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 17:39:55,934 - INFO - Document 4 of 3993:
2024-07-12 17:39:55,934 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 17:39:55,934 - INFO - Document 5 of 3993:
2024-07-12 17:39:55,934 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 17:39:55,939 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 17:39:55,939 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 17:39:55,943 - INFO - Loading faiss.
2024-07-12 17:39:55,997 - INFO - Successfully loaded faiss.
2024-07-12 17:39:56,013 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 17:39:56,015 - INFO - ====== WebDriver manager ======
2024-07-12 17:39:56,227 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:39:56,280 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:39:56,331 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
INFO:     Application startup complete.
ERROR:    [Errno 48] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
2024-07-12 17:39:57.438 Port 8505 is already in use
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11904]
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [11640]
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [12728]
INFO:     Waiting for application startup.
2024-07-12 17:41:18,753 - INFO - Getting bedrock client...
2024-07-12 17:41:18,758 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 17:41:19,026 - INFO - Initializing Bedrock...
2024-07-12 17:41:19,034 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 17:41:19,278 - INFO - Initializing Titan Embeddings Model...
2024-07-12 17:41:19,278 - INFO - Titan Embeddings Model initialized.
2024-07-12 17:41:19,278 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 17:41:19,313 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 17:41:19,313 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 17:41:19,323 - INFO - Documents file loaded successfully!
2024-07-12 17:41:19,323 - INFO - Structured documents created:
2024-07-12 17:41:19,323 - INFO - Document 1 of 3993:
2024-07-12 17:41:19,323 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 17:41:19,323 - INFO - Document 2 of 3993:
2024-07-12 17:41:19,323 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 17:41:19,323 - INFO - Document 3 of 3993:
2024-07-12 17:41:19,323 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 17:41:19,323 - INFO - Document 4 of 3993:
2024-07-12 17:41:19,323 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 17:41:19,323 - INFO - Document 5 of 3993:
2024-07-12 17:41:19,323 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 17:41:19,328 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 17:41:19,328 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 17:41:19,332 - INFO - Loading faiss.
2024-07-12 17:41:19,386 - INFO - Successfully loaded faiss.
2024-07-12 17:41:19,402 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 17:41:19,404 - INFO - ====== WebDriver manager ======
2024-07-12 17:41:19,615 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:41:19,668 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:41:19,718 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 17:41:20.844 Port 8505 is already in use
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [12802]
INFO:     Waiting for application startup.
2024-07-12 17:42:28,465 - INFO - Getting bedrock client...
2024-07-12 17:42:28,470 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 17:42:28,732 - INFO - Initializing Bedrock...
2024-07-12 17:42:28,739 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 17:42:28,993 - INFO - Initializing Titan Embeddings Model...
2024-07-12 17:42:28,993 - INFO - Titan Embeddings Model initialized.
2024-07-12 17:42:28,993 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 17:42:29,028 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 17:42:29,028 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 17:42:29,038 - INFO - Documents file loaded successfully!
2024-07-12 17:42:29,038 - INFO - Structured documents created:
2024-07-12 17:42:29,038 - INFO - Document 1 of 3993:
2024-07-12 17:42:29,038 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 17:42:29,038 - INFO - Document 2 of 3993:
2024-07-12 17:42:29,038 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 17:42:29,038 - INFO - Document 3 of 3993:
2024-07-12 17:42:29,038 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 17:42:29,038 - INFO - Document 4 of 3993:
2024-07-12 17:42:29,038 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 17:42:29,038 - INFO - Document 5 of 3993:
2024-07-12 17:42:29,038 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 17:42:29,043 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 17:42:29,043 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 17:42:29,048 - INFO - Loading faiss.
2024-07-12 17:42:29,103 - INFO - Successfully loaded faiss.
2024-07-12 17:42:29,121 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 17:42:29,124 - INFO - ====== WebDriver manager ======
2024-07-12 17:42:29,318 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:42:29,372 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 17:42:29,423 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
INFO:     Application startup complete.
ERROR:    [Errno 48] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
2024-07-12 17:42:30.564 Port 8505 is already in use
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [13047]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 48] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
2024-07-12 17:46:00.362 Port 8505 is already in use
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [13077]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 48] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
2024-07-12 17:46:19.596 Port 8505 is already in use
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [12728]
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [13246]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 17:47:15.932 Port 8505 is already in use
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [13246]
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [13690]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 17:52:18.480 Port 8505 is already in use
ERROR:    ASGI callable returned without starting response.
INFO:     127.0.0.1:51691 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
  Stopping...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [13990]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 48] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
  Stopping...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [13690]
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [14048]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
ERROR:    ASGI callable returned without starting response.
INFO:     127.0.0.1:52140 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [14048]
  Stopping...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [14349]
INFO:     Waiting for application startup.
2024-07-12 18:01:55,397 - INFO - Getting bedrock client...
2024-07-12 18:01:55,402 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:01:55,675 - INFO - Initializing Bedrock...
2024-07-12 18:01:55,680 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:01:55,918 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:01:55,918 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:01:55,918 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:01:55,941 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:01:55,942 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:01:55,951 - INFO - Documents file loaded successfully!
2024-07-12 18:01:55,951 - INFO - Structured documents created:
2024-07-12 18:01:55,951 - INFO - Document 1 of 3993:
2024-07-12 18:01:55,951 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:01:55,951 - INFO - Document 2 of 3993:
2024-07-12 18:01:55,951 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:01:55,951 - INFO - Document 3 of 3993:
2024-07-12 18:01:55,951 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:01:55,951 - INFO - Document 4 of 3993:
2024-07-12 18:01:55,951 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:01:55,951 - INFO - Document 5 of 3993:
2024-07-12 18:01:55,951 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:01:55,955 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:01:55,955 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:01:55,960 - INFO - Loading faiss.
2024-07-12 18:01:56,017 - INFO - Successfully loaded faiss.
2024-07-12 18:01:56,034 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:01:56,036 - INFO - ====== WebDriver manager ======
2024-07-12 18:01:56,238 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:01:56,332 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:01:56,382 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:01:56,959 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:02:38,358 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:02:45,607 - ERROR - Error processing chat question: 'dfaa4fb6-f90c-4ac1-af4f-1d281ad6e866'
2024-07-12 18:02:45,607 - ERROR - Error in /ask_question: 'dfaa4fb6-f90c-4ac1-af4f-1d281ad6e866'
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
Time for extract_customer_attributes: 2.0303239822387695
Time for split_process_and_message_from_response: 0.00048089027404785156
INFO:     127.0.0.1:52522 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [14869]
INFO:     Waiting for application startup.
2024-07-12 18:09:38,805 - INFO - Getting bedrock client...
2024-07-12 18:09:38,810 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:09:39,090 - INFO - Initializing Bedrock...
2024-07-12 18:09:39,095 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:09:39,348 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:09:39,348 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:09:39,348 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:09:39,383 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:09:39,383 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:09:39,392 - INFO - Documents file loaded successfully!
2024-07-12 18:09:39,392 - INFO - Structured documents created:
2024-07-12 18:09:39,392 - INFO - Document 1 of 3993:
2024-07-12 18:09:39,392 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:09:39,392 - INFO - Document 2 of 3993:
2024-07-12 18:09:39,392 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:09:39,392 - INFO - Document 3 of 3993:
2024-07-12 18:09:39,392 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:09:39,392 - INFO - Document 4 of 3993:
2024-07-12 18:09:39,392 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:09:39,392 - INFO - Document 5 of 3993:
2024-07-12 18:09:39,392 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:09:39,397 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:09:39,397 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:09:39,402 - INFO - Loading faiss.
2024-07-12 18:09:39,455 - INFO - Successfully loaded faiss.
2024-07-12 18:09:39,470 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:09:39,472 - INFO - ====== WebDriver manager ======
2024-07-12 18:09:39,676 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:09:39,727 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:09:39,776 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:09:40,500 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:09:56,837 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:10:03,043 - ERROR - Error processing chat question: '147b9d06-300a-4c1a-9f26-902d5360f963'
2024-07-12 18:10:03,044 - ERROR - Error in /ask_question: '147b9d06-300a-4c1a-9f26-902d5360f963'
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
Time for extract_customer_attributes: 1.9398491382598877
Time for split_process_and_message_from_response: 0.0003902912139892578
INFO:     127.0.0.1:53067 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [15373]
INFO:     Waiting for application startup.
2024-07-12 18:21:05,250 - INFO - Getting bedrock client...
2024-07-12 18:21:05,256 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:21:05,533 - INFO - Initializing Bedrock...
2024-07-12 18:21:05,538 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:21:05,770 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:21:05,770 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:21:05,771 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:21:05,811 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:21:05,811 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:21:05,824 - INFO - Documents file loaded successfully!
2024-07-12 18:21:05,824 - INFO - Structured documents created:
2024-07-12 18:21:05,824 - INFO - Document 1 of 3993:
2024-07-12 18:21:05,824 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:21:05,824 - INFO - Document 2 of 3993:
2024-07-12 18:21:05,824 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:21:05,824 - INFO - Document 3 of 3993:
2024-07-12 18:21:05,824 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:21:05,824 - INFO - Document 4 of 3993:
2024-07-12 18:21:05,824 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:21:05,824 - INFO - Document 5 of 3993:
2024-07-12 18:21:05,824 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:21:05,829 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:21:05,829 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:21:05,833 - INFO - Loading faiss.
2024-07-12 18:21:05,899 - INFO - Successfully loaded faiss.
2024-07-12 18:21:05,917 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:21:05,921 - INFO - ====== WebDriver manager ======
2024-07-12 18:21:06,144 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:21:06,198 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:21:06,248 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:21:06,750 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:21:35,045 - INFO - Processing question: I NEED A HAT FOR SUN PROTECTION
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:21:37,066 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:21:45,735 - ERROR - Error processing chat question: object tuple can't be used in 'await' expression
2024-07-12 18:21:45,736 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 121, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

2024-07-12 18:21:45,736 - ERROR - Error in /ask_question: object tuple can't be used in 'await' expression
2024-07-12 18:21:45,737 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 88, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 121, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
Time for extract_customer_attributes: 2.019251823425293
Time for split_process_and_message_from_response: 0.00043082237243652344
INFO:     127.0.0.1:53890 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [15512]
INFO:     Waiting for application startup.
2024-07-12 18:23:53,149 - INFO - Getting bedrock client...
2024-07-12 18:23:53,159 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:23:53,598 - INFO - Initializing Bedrock...
2024-07-12 18:23:53,603 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:23:53,847 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:23:53,847 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:23:53,847 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:23:53,873 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:23:53,873 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:23:53,883 - INFO - Documents file loaded successfully!
2024-07-12 18:23:53,883 - INFO - Structured documents created:
2024-07-12 18:23:53,883 - INFO - Document 1 of 3993:
2024-07-12 18:23:53,883 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:23:53,883 - INFO - Document 2 of 3993:
2024-07-12 18:23:53,883 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:23:53,883 - INFO - Document 3 of 3993:
2024-07-12 18:23:53,883 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:23:53,883 - INFO - Document 4 of 3993:
2024-07-12 18:23:53,883 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:23:53,883 - INFO - Document 5 of 3993:
2024-07-12 18:23:53,883 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:23:53,888 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:23:53,888 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:23:53,893 - INFO - Loading faiss.
2024-07-12 18:23:53,967 - INFO - Successfully loaded faiss.
2024-07-12 18:23:53,986 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:23:53,988 - INFO - ====== WebDriver manager ======
2024-07-12 18:23:54,212 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:23:54,308 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:23:54,374 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:23:54,869 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:24:18,383 - INFO - Received question: LOOKING FOR A HAT with session_id: 9ad51b13-a52e-4c80-86fc-c950d25d57d7
2024-07-12 18:24:18,383 - INFO - Current chat history for session_id 9ad51b13-a52e-4c80-86fc-c950d25d57d7: []
2024-07-12 18:24:18,383 - INFO - Processing question: LOOKING FOR A HAT
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:24:19,525 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:24:34,307 - ERROR - Error processing chat question: object tuple can't be used in 'await' expression
2024-07-12 18:24:34,309 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 126, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

2024-07-12 18:24:34,309 - ERROR - Error in /ask_question: object tuple can't be used in 'await' expression
2024-07-12 18:24:34,309 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 89, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 126, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
Invalid JSON: 

Time for extract_customer_attributes: 1.1412460803985596
Time for split_process_and_message_from_response: 0.0005350112915039062
INFO:     127.0.0.1:54123 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [15759]
INFO:     Waiting for application startup.
2024-07-12 18:26:26,543 - INFO - Getting bedrock client...
2024-07-12 18:26:26,555 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:26:26,863 - INFO - Initializing Bedrock...
2024-07-12 18:26:26,868 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:26:27,163 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:26:27,163 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:26:27,163 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:26:27,212 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:26:27,212 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:26:27,228 - INFO - Documents file loaded successfully!
2024-07-12 18:26:27,229 - INFO - Structured documents created:
2024-07-12 18:26:27,229 - INFO - Document 1 of 3993:
2024-07-12 18:26:27,229 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:26:27,229 - INFO - Document 2 of 3993:
2024-07-12 18:26:27,229 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:26:27,229 - INFO - Document 3 of 3993:
2024-07-12 18:26:27,229 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:26:27,229 - INFO - Document 4 of 3993:
2024-07-12 18:26:27,229 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:26:27,229 - INFO - Document 5 of 3993:
2024-07-12 18:26:27,229 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:26:27,234 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:26:27,234 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:26:27,238 - INFO - Loading faiss.
2024-07-12 18:26:27,310 - INFO - Successfully loaded faiss.
2024-07-12 18:26:27,326 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:26:27,328 - INFO - ====== WebDriver manager ======
2024-07-12 18:26:27,538 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:26:27,589 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:26:27,644 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:26:28,330 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:26:43,297 - INFO - Received question: Hats for sun protection with session_id: 0e55f14b-b525-4f4a-940f-1b0ef760207a
2024-07-12 18:26:43,297 - INFO - Current chat history for session_id 0e55f14b-b525-4f4a-940f-1b0ef760207a: []
2024-07-12 18:26:43,297 - INFO - Processing question: Hats for sun protection
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:26:45,849 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:26:53,635 - ERROR - Error processing chat question: object tuple can't be used in 'await' expression
2024-07-12 18:26:53,637 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 126, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

2024-07-12 18:26:53,637 - ERROR - Error in /ask_question: object tuple can't be used in 'await' expression
2024-07-12 18:26:53,637 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 89, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 126, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
Time for extract_customer_attributes: 2.551362991333008
Time for split_process_and_message_from_response: 0.0005269050598144531
INFO:     127.0.0.1:54322 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [15920]
INFO:     Waiting for application startup.
2024-07-12 18:29:12,224 - INFO - Getting bedrock client...
2024-07-12 18:29:12,231 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:29:12,544 - INFO - Initializing Bedrock...
2024-07-12 18:29:12,551 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:29:12,775 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:29:12,775 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:29:12,775 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:29:12,803 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:29:12,803 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:29:12,813 - INFO - Documents file loaded successfully!
2024-07-12 18:29:12,814 - INFO - Structured documents created:
2024-07-12 18:29:12,814 - INFO - Document 1 of 3993:
2024-07-12 18:29:12,814 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:29:12,814 - INFO - Document 2 of 3993:
2024-07-12 18:29:12,814 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:29:12,814 - INFO - Document 3 of 3993:
2024-07-12 18:29:12,814 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:29:12,814 - INFO - Document 4 of 3993:
2024-07-12 18:29:12,814 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:29:12,814 - INFO - Document 5 of 3993:
2024-07-12 18:29:12,814 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:29:12,818 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:29:12,818 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:29:12,823 - INFO - Loading faiss.
2024-07-12 18:29:12,893 - INFO - Successfully loaded faiss.
2024-07-12 18:29:12,913 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:29:12,915 - INFO - ====== WebDriver manager ======
2024-07-12 18:29:13,109 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:29:13,161 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:29:13,219 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:29:13,720 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:29:22,854 - INFO - Received question: Hats for sun protection with session_id: 68b09769-9860-403b-8ba3-adf0d6fb4dd2
2024-07-12 18:29:22,855 - INFO - Current chat history for session_id 68b09769-9860-403b-8ba3-adf0d6fb4dd2: []
2024-07-12 18:29:22,855 - INFO - Processing question: Hats for sun protection
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:29:25,123 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:29:31,575 - INFO - chat_procesing: message: Here are two sun protection hats from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 18:29:31,575 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6'}]}
2024-07-12 18:29:31,576 - ERROR - Error processing chat question: object tuple can't be used in 'await' expression
2024-07-12 18:29:31,577 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 126, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

2024-07-12 18:29:31,577 - ERROR - Error in /ask_question: object tuple can't be used in 'await' expression
2024-07-12 18:29:31,577 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 89, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 126, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
Time for extract_customer_attributes: 2.2666890621185303
Time for split_process_and_message_from_response: 0.00037598609924316406
INFO:     127.0.0.1:54535 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [16074]
INFO:     Waiting for application startup.
2024-07-12 18:32:30,979 - INFO - Getting bedrock client...
2024-07-12 18:32:30,984 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:32:31,234 - INFO - Initializing Bedrock...
2024-07-12 18:32:31,239 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:32:31,460 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:32:31,460 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:32:31,460 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:32:31,485 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:32:31,485 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:32:31,494 - INFO - Documents file loaded successfully!
2024-07-12 18:32:31,494 - INFO - Structured documents created:
2024-07-12 18:32:31,494 - INFO - Document 1 of 3993:
2024-07-12 18:32:31,494 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:32:31,494 - INFO - Document 2 of 3993:
2024-07-12 18:32:31,494 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:32:31,494 - INFO - Document 3 of 3993:
2024-07-12 18:32:31,494 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:32:31,494 - INFO - Document 4 of 3993:
2024-07-12 18:32:31,494 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:32:31,494 - INFO - Document 5 of 3993:
2024-07-12 18:32:31,494 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:32:31,498 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:32:31,498 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:32:31,503 - INFO - Loading faiss.
2024-07-12 18:32:31,561 - INFO - Successfully loaded faiss.
2024-07-12 18:32:31,579 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:32:31,580 - INFO - ====== WebDriver manager ======
2024-07-12 18:32:31,802 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:32:31,855 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:32:31,910 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:32:32,587 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:32:49,085 - INFO - Received question: Hat for sun protection with session_id: 2e499377-85f9-4010-b650-963d82ab67ae
2024-07-12 18:32:49,086 - INFO - Current chat history for session_id 2e499377-85f9-4010-b650-963d82ab67ae: []
2024-07-12 18:32:49,086 - INFO - Processing question: Hat for sun protection
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:32:50,917 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:32:58,629 - INFO - chat_procesing: message: Here are some hat options that can provide sun protection:

GLOWEAR BY ERGODYNE Baseball Cap (Code: 1CXK5) - Orange baseball hat with curved brim to shade eyes. Polyester material. 

GLOWEAR BY ERGODYNE Baseball Cap (Code: 1CXK6) - Green baseball hat with curved brim to shade eyes. Polyester material.

CONDOR Baseball Hat (Code: 25F541) - Orange baseball hat with curved brim to shade eyes. Polyester material.
2024-07-12 18:32:58,629 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6'}, {'product': 'CONDOR Baseball Hat: Orange, Universal, Front Brim Hat Hat, Polyester, Gen Purpose CONDOR Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '25F541'}]}
2024-07-12 18:32:58,629 - INFO - Message: Here are some hat options that can provide sun protection:

GLOWEAR BY ERGODYNE Baseball Cap (Code: 1CXK5) - Orange baseball hat with curved brim to shade eyes. Polyester material. 

GLOWEAR BY ERGODYNE Baseball Cap (Code: 1CXK6) - Green baseball hat with curved brim to shade eyes. Polyester material.

CONDOR Baseball Hat (Code: 25F541) - Orange baseball hat with curved brim to shade eyes. Polyester material.
2024-07-12 18:32:58,629 - INFO - Response json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6'}, {'product': 'CONDOR Baseball Hat: Orange, Universal, Front Brim Hat Hat, Polyester, Gen Purpose CONDOR Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '25F541'}]}
2024-07-12 18:32:58,629 - INFO - Customer attributes retrieved: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 18:32:58,629 - INFO - Time to get attributes: 1.8317887783050537
2024-07-12 18:32:58,629 - ERROR - Error processing chat question: '2e499377-85f9-4010-b650-963d82ab67ae'
2024-07-12 18:32:58,632 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 136, in process_chat_question
    session_store[session_id].append(
    ~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: '2e499377-85f9-4010-b650-963d82ab67ae'

2024-07-12 18:32:58,632 - ERROR - Error in /ask_question: '2e499377-85f9-4010-b650-963d82ab67ae'
2024-07-12 18:32:58,632 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 89, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 136, in process_chat_question
    session_store[session_id].append(
    ~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: '2e499377-85f9-4010-b650-963d82ab67ae'

Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
Time for extract_customer_attributes: 1.8305540084838867
Time for split_process_and_message_from_response: 0.0005853176116943359
INFO:     127.0.0.1:54805 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [16441]
INFO:     Waiting for application startup.
2024-07-12 18:36:47,236 - INFO - Getting bedrock client...
2024-07-12 18:36:47,244 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:36:47,494 - INFO - Initializing Bedrock...
2024-07-12 18:36:47,499 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:36:47,726 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:36:47,726 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:36:47,726 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:36:47,750 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:36:47,751 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:36:47,759 - INFO - Documents file loaded successfully!
2024-07-12 18:36:47,759 - INFO - Structured documents created:
2024-07-12 18:36:47,759 - INFO - Document 1 of 3993:
2024-07-12 18:36:47,759 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:36:47,759 - INFO - Document 2 of 3993:
2024-07-12 18:36:47,759 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:36:47,759 - INFO - Document 3 of 3993:
2024-07-12 18:36:47,759 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:36:47,759 - INFO - Document 4 of 3993:
2024-07-12 18:36:47,759 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:36:47,759 - INFO - Document 5 of 3993:
2024-07-12 18:36:47,759 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:36:47,764 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:36:47,764 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:36:47,768 - INFO - Loading faiss.
2024-07-12 18:36:47,825 - INFO - Successfully loaded faiss.
2024-07-12 18:36:47,842 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:36:47,844 - INFO - ====== WebDriver manager ======
2024-07-12 18:36:48,061 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:36:48,119 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:36:48,167 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:36:48,656 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:37:12,935 - ERROR - Session ID 6f47246c-81f4-4cd0-a042-e2c950a0119d not found in session_store
2024-07-12 18:37:12,935 - ERROR - Error in /ask_question: 400: Invalid Session ID
2024-07-12 18:37:12,935 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 90, in ask_question
    raise HTTPException(status_code=400, detail="Invalid Session ID")
fastapi.exceptions.HTTPException: 400: Invalid Session ID

Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:55144 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 18:37:14,945 - ERROR - Session ID 6f47246c-81f4-4cd0-a042-e2c950a0119d not found in session_store
2024-07-12 18:37:14,945 - ERROR - Error in /ask_question: 400: Invalid Session ID
2024-07-12 18:37:14,945 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 90, in ask_question
    raise HTTPException(status_code=400, detail="Invalid Session ID")
fastapi.exceptions.HTTPException: 400: Invalid Session ID

INFO:     127.0.0.1:55155 - "POST /ask_question HTTP/1.1" 500 Internal Server Error

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [16932]
INFO:     Waiting for application startup.
2024-07-12 18:49:07,135 - INFO - Getting bedrock client...
2024-07-12 18:49:07,142 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:49:07,185 - INFO - Generating session state variables...
2024-07-12 18:49:07,185 - INFO - Getting bedrock client...
2024-07-12 18:49:07,190 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:49:07,401 - INFO - Initializing Bedrock...
2024-07-12 18:49:07,406 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:49:07,435 - INFO - Initializing Bedrock...
2024-07-12 18:49:07,439 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:49:07,646 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:49:07,646 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:49:07,646 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:49:07,674 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:49:07,674 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:49:07,684 - INFO - Documents file loaded successfully!
2024-07-12 18:49:07,685 - INFO - Structured documents created:
2024-07-12 18:49:07,685 - INFO - Document 1 of 3993:
2024-07-12 18:49:07,685 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:49:07,685 - INFO - Document 2 of 3993:
2024-07-12 18:49:07,685 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:49:07,685 - INFO - Document 3 of 3993:
2024-07-12 18:49:07,685 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:49:07,685 - INFO - Document 4 of 3993:
2024-07-12 18:49:07,685 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:49:07,685 - INFO - Document 5 of 3993:
2024-07-12 18:49:07,685 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:49:07,689 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:49:07,689 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:49:07,696 - INFO - Loading faiss.
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:49:07,717 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:49:07,717 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:49:07,717 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:49:07,743 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:49:07,743 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:49:07,754 - INFO - Documents file loaded successfully!
2024-07-12 18:49:07,754 - INFO - Structured documents created:
2024-07-12 18:49:07,754 - INFO - Document 1 of 3993:
2024-07-12 18:49:07,754 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:49:07,754 - INFO - Document 2 of 3993:
2024-07-12 18:49:07,754 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:49:07,754 - INFO - Document 3 of 3993:
2024-07-12 18:49:07,754 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:49:07,754 - INFO - Document 4 of 3993:
2024-07-12 18:49:07,754 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:49:07,754 - INFO - Document 5 of 3993:
2024-07-12 18:49:07,754 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:49:07,758 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:49:07,759 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:49:07,763 - INFO - Loading faiss.
2024-07-12 18:49:07,765 - INFO - Successfully loaded faiss.
2024-07-12 18:49:07,774 - INFO - Successfully loaded faiss.
2024-07-12 18:49:07,782 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:49:07,784 - INFO - ====== WebDriver manager ======
2024-07-12 18:49:07,852 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:49:07,854 - INFO - ====== WebDriver manager ======
2024-07-12 18:49:07,996 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:49:08,040 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:49:08,265 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:49:08,265 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:49:08,322 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:49:08,322 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:49:09,042 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:49:09,055 - INFO - Session initialized with ID: 10624c5f-4215-4b02-9949-535e199fe623
2024-07-12 18:49:09,056 - INFO - Initialized session with ID: 10624c5f-4215-4b02-9949-535e199fe623
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:56067 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 18:49:09,057 - INFO - Asking question
2024-07-12 18:49:38,918 - INFO - Using session state variables...
2024-07-12 18:49:38,919 - INFO - ====== WebDriver manager ======
2024-07-12 18:49:39,154 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:49:39,210 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:49:39,269 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:49:39,997 - INFO - Session initialized with ID: ffca3307-f611-4e61-b0b0-75e125d15e54
INFO:     127.0.0.1:56124 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 18:49:39,997 - INFO - Initialized session with ID: ffca3307-f611-4e61-b0b0-75e125d15e54
2024-07-12 18:49:39,998 - INFO - Asking question
2024-07-12 18:49:39,998 - INFO - Question entered: I am looking for a hat for sun protection that I can buy in bulk for construction workers in Kansas.
2024-07-12 18:49:40,000 - INFO - Received question: I am looking for a hat for sun protection that I can buy in bulk for construction workers in Kansas. with session_id: ffca3307-f611-4e61-b0b0-75e125d15e54
2024-07-12 18:49:40,000 - INFO - Current chat history for session_id ffca3307-f611-4e61-b0b0-75e125d15e54: []
2024-07-12 18:49:40,000 - INFO - Processing question: I am looking for a hat for sun protection that I can buy in bulk for construction workers in Kansas.
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:49:41,946 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:49:48,823 - INFO - chat_procesing: message: Here are two hat options that could work for providing sun protection for construction workers in Kansas:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose 

1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose

These are polyester baseball cap style hats that come in universal sizing and different color options. The curved brim helps shade the eyes from the sun. As requested, I have provided the product descriptions and codes for these two hat options from the catalog that seem suitable for your needs.
2024-07-12 18:49:48,823 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}, {'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}]}
2024-07-12 18:49:48,823 - INFO - Message: Here are two hat options that could work for providing sun protection for construction workers in Kansas:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose 

1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose

These are polyester baseball cap style hats that come in universal sizing and different color options. The curved brim helps shade the eyes from the sun. As requested, I have provided the product descriptions and codes for these two hat options from the catalog that seem suitable for your needs.
2024-07-12 18:49:48,823 - INFO - Response json: {'products': [{'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}, {'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}]}
2024-07-12 18:49:48,823 - INFO - Customer attributes retrieved: {'Industry': 'Other', 'Size': 'Large Enterprises', 'SustainabilityFocused': False, 'InventoryManager': True, 'Location': 'Kansas'}
2024-07-12 18:49:48,823 - INFO - Time to get attributes: 1.9459199905395508
2024-07-12 18:49:48,823 - INFO - Updated chat history for session_id ffca3307-f611-4e61-b0b0-75e125d15e54: [[{'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}, {'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}], ["QUESTION: I am looking for a hat for sun protection that I can buy in bulk for construction workers in Kansas.. MESSAGE: Here are two hat options that could work for providing sun protection for construction workers in Kansas:\n\n1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose \n\n1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose\n\nThese are polyester baseball cap style hats that come in universal sizing and different color options. The curved brim helps shade the eyes from the sun. As requested, I have provided the product descriptions and codes for these two hat options from the catalog that seem suitable for your needs.. CUSTOMER ATTRIBUTES: {'Industry': 'Other', 'Size': 'Large Enterprises', 'SustainabilityFocused': False, 'InventoryManager': True, 'Location': 'Kansas'}"]]
2024-07-12 18:49:48,824 - INFO - Processed question: I am looking for a hat for sun protection that I can buy in bulk for construction workers in Kansas. with message: Here are two hat options that could work for providing sun protection for construction workers in Kansas:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose 

1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose

These are polyester baseball cap style hats that come in universal sizing and different color options. The curved brim helps shade the eyes from the sun. As requested, I have provided the product descriptions and codes for these two hat options from the catalog that seem suitable for your needs.
2024-07-12 18:49:48,824 - INFO - Products retrieved: [{'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}, {'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}]
2024-07-12 18:49:48,825 - INFO - Fetching images for products: ['Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK5', 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK6']
2024-07-12 18:49:48,835 - INFO - Fetching reviews for product: Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK5
2024-07-12 18:49:49,713 - INFO - Total time to fetch images: 0.0036122798919677734 seconds
2024-07-12 18:50:00,114 - INFO - Reviews for product 1CXK5: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Love it']}
2024-07-12 18:50:00,114 - INFO - Fetching reviews for product: Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK6
2024-07-12 18:50:10,428 - INFO - Reviews for product 1CXK6: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 18:50:10,428 - INFO - Total time taken for ask_question: 30.427319765090942 seconds
2024-07-12 18:50:10,428 - ERROR - Error in /ask_question: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Other', 'S..., 'Location': 'Kansas'}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type
2024-07-12 18:50:10,431 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 117, in ask_question
    return ChatResponse(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/pydantic/main.py", line 193, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Other', 'S..., 'Location': 'Kansas'}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type

Time for extract_customer_attributes: 1.9450469017028809
Time for split_process_and_message_from_response: 0.00038313865661621094
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK5_AS04?$lgmain$ for 1CXK5 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK6_AS06?$lgmain$ for 1CXK6 in 0.00 seconds
INFO:     127.0.0.1:56126 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 18:50:10,431 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 18:50:10.432 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [17190]
INFO:     Waiting for application startup.
2024-07-12 18:51:01,822 - INFO - Getting bedrock client...
2024-07-12 18:51:01,829 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:51:01,854 - INFO - Generating session state variables...
2024-07-12 18:51:01,854 - INFO - Getting bedrock client...
2024-07-12 18:51:01,859 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:51:02,092 - INFO - Initializing Bedrock...
2024-07-12 18:51:02,096 - INFO - Initializing Bedrock...
2024-07-12 18:51:02,097 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:51:02,101 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:51:02,336 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:51:02,336 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:51:02,336 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:51:02,343 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:51:02,343 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:51:02,343 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:51:02,364 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:51:02,364 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
2024-07-12 18:51:02,368 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:51:02,368 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:51:02,377 - INFO - Documents file loaded successfully!
2024-07-12 18:51:02,377 - INFO - Structured documents created:
2024-07-12 18:51:02,377 - INFO - Document 1 of 3993:
2024-07-12 18:51:02,377 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:51:02,377 - INFO - Document 2 of 3993:
2024-07-12 18:51:02,377 - INFO - Documents file loaded successfully!
2024-07-12 18:51:02,377 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:51:02,377 - INFO - Structured documents created:
2024-07-12 18:51:02,377 - INFO - Document 3 of 3993:
2024-07-12 18:51:02,377 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:51:02,377 - INFO - Document 1 of 3993:
2024-07-12 18:51:02,377 - INFO - Document 4 of 3993:
2024-07-12 18:51:02,377 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:51:02,377 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:51:02,377 - INFO - Document 5 of 3993:
2024-07-12 18:51:02,377 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:51:02,377 - INFO - Document 2 of 3993:
2024-07-12 18:51:02,377 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:51:02,377 - INFO - Document 3 of 3993:
2024-07-12 18:51:02,377 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:51:02,377 - INFO - Document 4 of 3993:
2024-07-12 18:51:02,377 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:51:02,377 - INFO - Document 5 of 3993:
2024-07-12 18:51:02,377 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:51:02,381 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:51:02,381 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:51:02,381 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:51:02,381 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:51:02,387 - INFO - Loading faiss.
2024-07-12 18:51:02,387 - INFO - Loading faiss.
2024-07-12 18:51:02,398 - INFO - Successfully loaded faiss.
2024-07-12 18:51:02,455 - INFO - Successfully loaded faiss.
2024-07-12 18:51:02,476 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:51:02,476 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:51:02,478 - INFO - ====== WebDriver manager ======
2024-07-12 18:51:02,478 - INFO - ====== WebDriver manager ======
2024-07-12 18:51:02,644 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:51:02,644 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:51:02,697 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:51:02,697 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:51:02,750 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:51:02,750 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:51:03,465 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:51:03,474 - INFO - Session initialized with ID: d2a79c41-3778-48a1-af42-41ae733d92f9
2024-07-12 18:51:03,474 - INFO - Initialized session with ID: d2a79c41-3778-48a1-af42-41ae733d92f9
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:56368 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 18:51:03,475 - INFO - Asking question
2024-07-12 18:53:04,424 - INFO - Using session state variables...
2024-07-12 18:53:04,425 - INFO - ====== WebDriver manager ======
2024-07-12 18:53:04,650 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:53:04,726 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:53:04,774 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:53:05,333 - INFO - Session initialized with ID: b209c1ea-b1ae-4e9e-bb8c-1274290073ed
2024-07-12 18:53:05,333 - INFO - Initialized session with ID: b209c1ea-b1ae-4e9e-bb8c-1274290073ed
INFO:     127.0.0.1:56522 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 18:53:05,334 - INFO - Asking question
2024-07-12 18:53:05,334 - INFO - Question entered: Hat for sun protection for my outdoor construction workers in Indiana
2024-07-12 18:53:05,336 - INFO - Received question: Hat for sun protection for my outdoor construction workers in Indiana with session_id: b209c1ea-b1ae-4e9e-bb8c-1274290073ed
2024-07-12 18:53:05,336 - INFO - Current chat history for session_id b209c1ea-b1ae-4e9e-bb8c-1274290073ed: []
2024-07-12 18:53:05,336 - INFO - Processing question: Hat for sun protection for my outdoor construction workers in Indiana
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:53:07,595 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 18:53:18,118 - INFO - chat_procesing: message: Based on the question asking for hat recommendations for sun protection for construction workers in Indiana, I have identified 3 relevant products from the catalog:

1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green 
1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green

These baseball caps and cooling hats can provide shade and UV protection for the eyes and neck area to help reduce sun exposure for outdoor workers. The green and orange colors offer high visibility.
2024-07-12 18:53:18,118 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK6'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK5'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE', 'code': '2EMK4'}]}
2024-07-12 18:53:18,118 - INFO - Message: Based on the question asking for hat recommendations for sun protection for construction workers in Indiana, I have identified 3 relevant products from the catalog:

1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green 
1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green

These baseball caps and cooling hats can provide shade and UV protection for the eyes and neck area to help reduce sun exposure for outdoor workers. The green and orange colors offer high visibility.
2024-07-12 18:53:18,118 - INFO - Response json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK6'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK5'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE', 'code': '2EMK4'}]}
2024-07-12 18:53:18,118 - INFO - Customer attributes retrieved: {'Industry': 'Construction', 'Size': 'Small Businesses', 'SustainabilityFocused': False, 'InventoryManager': False, 'Location': 'Indiana'}
2024-07-12 18:53:18,118 - INFO - Time to get attributes: 2.2589328289031982
2024-07-12 18:53:18,118 - INFO - Updated chat history for session_id b209c1ea-b1ae-4e9e-bb8c-1274290073ed: [[{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK6'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK5'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE', 'code': '2EMK4'}], ["QUESTION: Hat for sun protection for my outdoor construction workers in Indiana. MESSAGE: Based on the question asking for hat recommendations for sun protection for construction workers in Indiana, I have identified 3 relevant products from the catalog:\n\n1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green \n1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange\n2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green\n\nThese baseball caps and cooling hats can provide shade and UV protection for the eyes and neck area to help reduce sun exposure for outdoor workers. The green and orange colors offer high visibility.. CUSTOMER ATTRIBUTES: {'Industry': 'Construction', 'Size': 'Small Businesses', 'SustainabilityFocused': False, 'InventoryManager': False, 'Location': 'Indiana'}"]]
2024-07-12 18:53:18,118 - INFO - Processed question: Hat for sun protection for my outdoor construction workers in Indiana with message: Based on the question asking for hat recommendations for sun protection for construction workers in Indiana, I have identified 3 relevant products from the catalog:

1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green 
1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green

These baseball caps and cooling hats can provide shade and UV protection for the eyes and neck area to help reduce sun exposure for outdoor workers. The green and orange colors offer high visibility.
2024-07-12 18:53:18,118 - INFO - Products retrieved: [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK6'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'code': '1CXK5'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE', 'code': '2EMK4'}]
2024-07-12 18:53:18,119 - INFO - Fetching images for products: ['GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE, 1CXK6', 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE, 1CXK5', 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE, 2EMK4']
2024-07-12 18:53:18,123 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE, 1CXK6
2024-07-12 18:53:18,313 - INFO - Total time to fetch images: 0.002881765365600586 seconds
2024-07-12 18:53:29,126 - INFO - Reviews for product 1CXK6: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 18:53:29,126 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE, 1CXK5
2024-07-12 18:53:39,378 - INFO - Reviews for product 1CXK5: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 18:53:39,378 - INFO - Fetching reviews for product: CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE, 2EMK4
2024-07-12 18:53:50,500 - INFO - Reviews for product 2EMK4: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Fast delivery.   Thank you so much!']}
2024-07-12 18:53:50,500 - INFO - Total time taken for ask_question: 45.1640887260437 seconds
2024-07-12 18:53:50,500 - ERROR - Error in /ask_question: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Constructi... 'Location': 'Indiana'}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type
2024-07-12 18:53:50,502 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 117, in ask_question
    return ChatResponse(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/pydantic/main.py", line 193, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Constructi... 'Location': 'Indiana'}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type

Time for extract_customer_attributes: 2.258307695388794
Time for split_process_and_message_from_response: 0.0003838539123535156
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK6_AS06?$lgmain$ for 1CXK6 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK5_AS04?$lgmain$ for 1CXK5 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/2EMK4_AS02?$lgmain$ for 2EMK4 in 0.00 seconds
INFO:     127.0.0.1:56524 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 18:53:50,502 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 18:53:50.503 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [17658]
INFO:     Waiting for application startup.
2024-07-12 18:59:49,578 - INFO - Getting bedrock client...
2024-07-12 18:59:49,585 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:59:49,598 - INFO - Generating session state variables...
2024-07-12 18:59:49,598 - INFO - Getting bedrock client...
2024-07-12 18:59:49,603 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:59:49,857 - INFO - Initializing Bedrock...
2024-07-12 18:59:49,859 - INFO - Initializing Bedrock...
2024-07-12 18:59:49,861 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 18:59:49,863 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:59:50,101 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:59:50,101 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:59:50,101 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 18:59:50,126 - INFO - Initializing Titan Embeddings Model...
2024-07-12 18:59:50,126 - INFO - Titan Embeddings Model initialized.
2024-07-12 18:59:50,126 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 18:59:50,130 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:59:50,130 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:59:50,141 - INFO - Documents file loaded successfully!
2024-07-12 18:59:50,141 - INFO - Structured documents created:
2024-07-12 18:59:50,141 - INFO - Document 1 of 3993:
2024-07-12 18:59:50,141 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:59:50,141 - INFO - Document 2 of 3993:
2024-07-12 18:59:50,141 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:59:50,141 - INFO - Document 3 of 3993:
2024-07-12 18:59:50,141 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:59:50,141 - INFO - Document 4 of 3993:
2024-07-12 18:59:50,141 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:59:50,141 - INFO - Document 5 of 3993:
2024-07-12 18:59:50,141 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:59:50,146 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:59:50,146 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:59:50,152 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 18:59:50,152 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
2024-07-12 18:59:50,153 - INFO - Loading faiss.
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 18:59:50,161 - INFO - Documents file loaded successfully!
2024-07-12 18:59:50,161 - INFO - Structured documents created:
2024-07-12 18:59:50,161 - INFO - Document 1 of 3993:
2024-07-12 18:59:50,161 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 18:59:50,161 - INFO - Document 2 of 3993:
2024-07-12 18:59:50,161 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 18:59:50,161 - INFO - Document 3 of 3993:
2024-07-12 18:59:50,161 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 18:59:50,161 - INFO - Document 4 of 3993:
2024-07-12 18:59:50,161 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 18:59:50,161 - INFO - Document 5 of 3993:
2024-07-12 18:59:50,161 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 18:59:50,163 - INFO - Successfully loaded faiss.
2024-07-12 18:59:50,165 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 18:59:50,165 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 18:59:50,170 - INFO - Loading faiss.
2024-07-12 18:59:50,239 - INFO - Successfully loaded faiss.
2024-07-12 18:59:50,245 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:59:50,247 - INFO - ====== WebDriver manager ======
2024-07-12 18:59:50,262 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 18:59:50,264 - INFO - ====== WebDriver manager ======
2024-07-12 18:59:50,458 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:59:50,459 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:59:50,534 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:59:50,534 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 18:59:50,601 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:59:50,601 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 18:59:51,149 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 18:59:51,158 - INFO - Session initialized with ID: 97dc5aaa-8ac6-46bb-a131-4a956c60e743
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:57129 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 18:59:51,160 - INFO - Initialized session with ID: 97dc5aaa-8ac6-46bb-a131-4a956c60e743
2024-07-12 18:59:51,161 - INFO - Asking question
2024-07-12 19:00:18,623 - INFO - Using session state variables...
2024-07-12 19:00:18,623 - INFO - ====== WebDriver manager ======
2024-07-12 19:00:18,836 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:00:18,901 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:00:18,955 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:00:19,732 - INFO - Session initialized with ID: 6b8c3a04-c599-42c8-907b-4927c89d8842
INFO:     127.0.0.1:57181 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:00:19,732 - INFO - Initialized session with ID: 6b8c3a04-c599-42c8-907b-4927c89d8842
2024-07-12 19:00:19,733 - INFO - Asking question
2024-07-12 19:00:19,733 - INFO - Question entered: Hats for sun protection
2024-07-12 19:00:19,735 - INFO - Received question: Hats for sun protection with session_id: 6b8c3a04-c599-42c8-907b-4927c89d8842
/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py:102: RuntimeWarning: coroutine 'process_chat_question' was never awaited
  message, response_json, customer_attributes_retrieved, time_to_get_attributes = process_chat_question(
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2024-07-12 19:00:19,736 - ERROR - Error in /ask_question: cannot unpack non-iterable coroutine object
2024-07-12 19:00:19,736 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 102, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = process_chat_question(
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: cannot unpack non-iterable coroutine object

INFO:     127.0.0.1:57183 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 19:00:19,737 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:00:19.737 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [18283]
INFO:     Waiting for application startup.
2024-07-12 19:12:38,313 - INFO - Getting bedrock client...
2024-07-12 19:12:38,318 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:12:38,499 - INFO - Generating session state variables...
2024-07-12 19:12:38,499 - INFO - Getting bedrock client...
2024-07-12 19:12:38,505 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:12:38,630 - INFO - Initializing Bedrock...
2024-07-12 19:12:38,634 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:12:38,736 - INFO - Initializing Bedrock...
2024-07-12 19:12:38,740 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:12:38,868 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:12:38,868 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:12:38,868 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:12:38,896 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:12:38,896 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:12:38,906 - INFO - Documents file loaded successfully!
2024-07-12 19:12:38,906 - INFO - Structured documents created:
2024-07-12 19:12:38,906 - INFO - Document 1 of 3993:
2024-07-12 19:12:38,906 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:12:38,906 - INFO - Document 2 of 3993:
2024-07-12 19:12:38,906 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:12:38,906 - INFO - Document 3 of 3993:
2024-07-12 19:12:38,906 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:12:38,906 - INFO - Document 4 of 3993:
2024-07-12 19:12:38,906 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:12:38,906 - INFO - Document 5 of 3993:
2024-07-12 19:12:38,906 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:12:38,910 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:12:38,910 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:12:38,915 - INFO - Loading faiss.
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:12:38,960 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:12:38,960 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:12:38,960 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:12:38,976 - INFO - Successfully loaded faiss.
2024-07-12 19:12:38,985 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:12:38,985 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:12:38,994 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:12:38,994 - INFO - Documents file loaded successfully!
2024-07-12 19:12:38,994 - INFO - Structured documents created:
2024-07-12 19:12:38,994 - INFO - Document 1 of 3993:
2024-07-12 19:12:38,994 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:12:38,994 - INFO - Document 2 of 3993:
2024-07-12 19:12:38,994 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:12:38,995 - INFO - Document 3 of 3993:
2024-07-12 19:12:38,995 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:12:38,995 - INFO - Document 4 of 3993:
2024-07-12 19:12:38,995 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:12:38,995 - INFO - Document 5 of 3993:
2024-07-12 19:12:38,995 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:12:38,995 - INFO - ====== WebDriver manager ======
2024-07-12 19:12:38,999 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:12:38,999 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:12:39,004 - INFO - Loading faiss.
2024-07-12 19:12:39,014 - INFO - Successfully loaded faiss.
2024-07-12 19:12:39,090 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:12:39,092 - INFO - ====== WebDriver manager ======
2024-07-12 19:12:39,200 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:12:39,257 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:12:39,292 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:12:39,314 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:12:39,367 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:12:39,422 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:12:39,862 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:12:39,871 - INFO - Session initialized with ID: 466f5b86-3b93-4616-98f7-83a15f8ab5c4
2024-07-12 19:12:39,871 - INFO - Initialized session with ID: 466f5b86-3b93-4616-98f7-83a15f8ab5c4
2024-07-12 19:12:39,872 - INFO - Asking question
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:58091 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:12:51,810 - INFO - Using session state variables...
2024-07-12 19:12:51,810 - INFO - ====== WebDriver manager ======
2024-07-12 19:12:52,042 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:12:52,095 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:12:52,142 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:12:52,763 - INFO - Session initialized with ID: fc93b5a9-9b79-4486-b20c-90e4042d7959
INFO:     127.0.0.1:58133 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:12:52,764 - INFO - Initialized session with ID: fc93b5a9-9b79-4486-b20c-90e4042d7959
2024-07-12 19:12:52,764 - INFO - Asking question
2024-07-12 19:12:52,765 - INFO - Question entered: hats for sun protection
2024-07-12 19:12:52,767 - INFO - Received question: hats for sun protection with session_id: fc93b5a9-9b79-4486-b20c-90e4042d7959
2024-07-12 19:12:52,767 - INFO - Current chat history for session_id fc93b5a9-9b79-4486-b20c-90e4042d7959: []
2024-07-12 19:12:52,767 - INFO - Processing question: hats for sun protection
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:12:54,977 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:13:03,393 - INFO - chat_procesing: message: Here are 4 hats that provide sun protection:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange 
1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green
2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange
2024-07-12 19:13:03,393 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}]}
2024-07-12 19:13:03,393 - INFO - Message: Here are 4 hats that provide sun protection:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange 
1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green
2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange
2024-07-12 19:13:03,393 - INFO - Response json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}]}
2024-07-12 19:13:03,393 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:13:03,393 - INFO - Time to get attributes: 2.2104408740997314
2024-07-12 19:13:03,393 - INFO - Updated chat history for session_id fc93b5a9-9b79-4486-b20c-90e4042d7959: [[{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}], ["QUESTION: hats for sun protection. MESSAGE: Here are 4 hats that provide sun protection:\n\n1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange \n1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green\n2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green\n2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:13:03,393 - INFO - Processed question: hats for sun protection with message: Here are 4 hats that provide sun protection:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange 
1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green
2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange
2024-07-12 19:13:03,393 - INFO - Products retrieved: [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}]
2024-07-12 19:13:03,393 - INFO - Fetching images for products: ['GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK5', 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK6', 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK4', 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK5']
2024-07-12 19:13:03,398 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK5
2024-07-12 19:13:03,833 - INFO - Total time to fetch images: 0.0033349990844726562 seconds
2024-07-12 19:13:19,569 - INFO - Reviews for product 1CXK5: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:13:19,569 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK6
2024-07-12 19:13:32,131 - INFO - Reviews for product 1CXK6: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:13:32,131 - INFO - Fetching reviews for product: CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK4
2024-07-12 19:13:45,981 - INFO - Reviews for product 2EMK4: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 19:13:45,981 - INFO - Fetching reviews for product: CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK5
2024-07-12 19:13:57,180 - INFO - Reviews for product 2EMK5: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 19:13:57,181 - INFO - Total time taken for ask_question: 64.41391324996948 seconds
2024-07-12 19:13:57,181 - ERROR - Error in /ask_question: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type
2024-07-12 19:13:57,183 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 117, in ask_question
    return ChatResponse(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/pydantic/main.py", line 193, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type

Time for extract_customer_attributes: 2.2097220420837402
Time for split_process_and_message_from_response: 0.0004398822784423828
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK5_AS04?$lgmain$ for 1CXK5 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK6_AS06?$lgmain$ for 1CXK6 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/2EMK4_AS02?$lgmain$ for 2EMK4 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/2EMK5_AS02?$lgmain$ for 2EMK5 in 0.00 seconds
INFO:     127.0.0.1:58135 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 19:13:57,183 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:13:57.184 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [18634]
INFO:     Waiting for application startup.
2024-07-12 19:21:26,991 - INFO - Getting bedrock client...
2024-07-12 19:21:26,998 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:21:27,010 - INFO - Generating session state variables...
2024-07-12 19:21:27,010 - INFO - Getting bedrock client...
2024-07-12 19:21:27,016 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:21:27,250 - INFO - Initializing Bedrock...
2024-07-12 19:21:27,255 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:21:27,255 - INFO - Initializing Bedrock...
2024-07-12 19:21:27,260 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:21:27,501 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:21:27,501 - INFO - Titan Embeddings Model initialized.
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:21:27,501 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:21:27,501 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:21:27,502 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:21:27,502 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:21:27,530 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:21:27,530 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
2024-07-12 19:21:27,530 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:21:27,530 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:21:27,543 - INFO - Documents file loaded successfully!
2024-07-12 19:21:27,543 - INFO - Documents file loaded successfully!
2024-07-12 19:21:27,543 - INFO - Structured documents created:
2024-07-12 19:21:27,543 - INFO - Document 1 of 3993:
2024-07-12 19:21:27,543 - INFO - Structured documents created:
2024-07-12 19:21:27,543 - INFO - Document 1 of 3993:
2024-07-12 19:21:27,543 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:21:27,543 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:21:27,543 - INFO - Document 2 of 3993:
2024-07-12 19:21:27,543 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:21:27,543 - INFO - Document 2 of 3993:
2024-07-12 19:21:27,544 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:21:27,544 - INFO - Document 3 of 3993:
2024-07-12 19:21:27,543 - INFO - Document 3 of 3993:
2024-07-12 19:21:27,544 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:21:27,544 - INFO - Document 4 of 3993:
2024-07-12 19:21:27,544 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:21:27,544 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:21:27,544 - INFO - Document 4 of 3993:
2024-07-12 19:21:27,544 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:21:27,544 - INFO - Document 5 of 3993:
2024-07-12 19:21:27,544 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:21:27,544 - INFO - Document 5 of 3993:
2024-07-12 19:21:27,544 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:21:27,548 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:21:27,548 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:21:27,548 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:21:27,548 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:21:27,554 - INFO - Loading faiss.
2024-07-12 19:21:27,554 - INFO - Loading faiss.
2024-07-12 19:21:27,565 - INFO - Successfully loaded faiss.
2024-07-12 19:21:27,622 - INFO - Successfully loaded faiss.
2024-07-12 19:21:27,644 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:21:27,646 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:21:27,646 - INFO - ====== WebDriver manager ======
2024-07-12 19:21:27,649 - INFO - ====== WebDriver manager ======
2024-07-12 19:21:27,842 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:21:27,842 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:21:27,895 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:21:27,897 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:21:27,947 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:21:27,951 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:21:28,572 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:21:28,580 - INFO - Session initialized with ID: 8bdc2e06-a843-411d-a262-f1a823bd05fd
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:58826 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:21:28,581 - INFO - Initialized session with ID: 8bdc2e06-a843-411d-a262-f1a823bd05fd
2024-07-12 19:21:28,582 - INFO - Asking question
2024-07-12 19:21:44,749 - INFO - Using session state variables...
2024-07-12 19:21:44,750 - INFO - ====== WebDriver manager ======
2024-07-12 19:21:44,995 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:21:45,054 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:21:45,104 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:21:45,771 - INFO - Session initialized with ID: 0c79ffec-a8f7-4fa7-a39c-d4f087661fcd
INFO:     127.0.0.1:58873 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:21:45,772 - INFO - Initialized session with ID: 0c79ffec-a8f7-4fa7-a39c-d4f087661fcd
2024-07-12 19:21:45,773 - INFO - Asking question
2024-07-12 19:21:45,773 - INFO - Question entered: Hats for sun protection in Arizona for construction workers.
2024-07-12 19:21:45,775 - INFO - Received question: Hats for sun protection in Arizona for construction workers. with session_id: 0c79ffec-a8f7-4fa7-a39c-d4f087661fcd
2024-07-12 19:21:45,775 - INFO - Current chat history for session_id 0c79ffec-a8f7-4fa7-a39c-d4f087661fcd: []
2024-07-12 19:21:45,775 - INFO - Processing question: Hats for sun protection in Arizona for construction workers.
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:21:48,053 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:21:56,139 - INFO - chat_procesing: message: Based on the construction industry in Arizona, I recommend the following hats for sun protection:

CHILL-ITS BY ERGODYNE Cooling Hat 2EMK4 - Green cooling hat with neck shade 
GLOWEAR BY ERGODYNE Baseball Cap 1CXK6 - Green baseball hat 
CHILL-ITS BY ERGODYNE Cooling Hat 2EMK5 - Orange cooling hat with neck shade

These wide-brimmed and cooling hats provide shade and UV protection for the head, neck, and eyes. The green and orange colors offer high visibility. The cooling fabric helps keep workers comfortable in the Arizona heat.
2024-07-12 19:21:56,140 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling', 'code': '2EMK4'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling', 'code': '2EMK5'}]}
2024-07-12 19:21:56,140 - ERROR - Error processing chat question: object tuple can't be used in 'await' expression
2024-07-12 19:21:56,141 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 139, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

2024-07-12 19:21:56,141 - ERROR - Error in /ask_question: object tuple can't be used in 'await' expression
2024-07-12 19:21:56,141 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 101, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 139, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

Time for extract_customer_attributes: 2.277304172515869
Time for split_process_and_message_from_response: 0.0003769397735595703
INFO:     127.0.0.1:58875 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 19:21:56,143 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:21:56.143 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [18860]
INFO:     Waiting for application startup.
2024-07-12 19:22:27,773 - INFO - Getting bedrock client...
2024-07-12 19:22:27,780 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:22:27,886 - INFO - Generating session state variables...
2024-07-12 19:22:27,886 - INFO - Getting bedrock client...
2024-07-12 19:22:27,891 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:22:28,021 - INFO - Initializing Bedrock...
2024-07-12 19:22:28,025 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:22:28,133 - INFO - Initializing Bedrock...
2024-07-12 19:22:28,137 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:22:28,255 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:22:28,255 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:22:28,255 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:22:28,281 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:22:28,281 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:22:28,290 - INFO - Documents file loaded successfully!
2024-07-12 19:22:28,290 - INFO - Structured documents created:
2024-07-12 19:22:28,290 - INFO - Document 1 of 3993:
2024-07-12 19:22:28,290 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:22:28,290 - INFO - Document 2 of 3993:
2024-07-12 19:22:28,290 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:22:28,290 - INFO - Document 3 of 3993:
2024-07-12 19:22:28,290 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:22:28,290 - INFO - Document 4 of 3993:
2024-07-12 19:22:28,290 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:22:28,290 - INFO - Document 5 of 3993:
2024-07-12 19:22:28,290 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:22:28,295 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:22:28,295 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:22:28,299 - INFO - Loading faiss.
2024-07-12 19:22:28,359 - INFO - Successfully loaded faiss.
2024-07-12 19:22:28,377 - INFO - FAISS vector store loaded from pickle file.
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:22:28,379 - INFO - ====== WebDriver manager ======
2024-07-12 19:22:28,379 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:22:28,380 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:22:28,380 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:22:28,405 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:22:28,405 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:22:28,415 - INFO - Documents file loaded successfully!
2024-07-12 19:22:28,415 - INFO - Structured documents created:
2024-07-12 19:22:28,415 - INFO - Document 1 of 3993:
2024-07-12 19:22:28,415 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:22:28,415 - INFO - Document 2 of 3993:
2024-07-12 19:22:28,415 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:22:28,415 - INFO - Document 3 of 3993:
2024-07-12 19:22:28,415 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:22:28,415 - INFO - Document 4 of 3993:
2024-07-12 19:22:28,415 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:22:28,415 - INFO - Document 5 of 3993:
2024-07-12 19:22:28,415 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:22:28,420 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:22:28,420 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:22:28,424 - INFO - Loading faiss.
2024-07-12 19:22:28,433 - INFO - Successfully loaded faiss.
2024-07-12 19:22:28,508 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:22:28,510 - INFO - ====== WebDriver manager ======
2024-07-12 19:22:28,612 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:22:28,680 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:22:28,712 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:22:28,744 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:22:28,794 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:22:28,846 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:22:29,293 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:22:29,305 - INFO - Session initialized with ID: f84c11ae-8c4f-46ef-86cd-d0ba7398e5ff
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:58966 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:22:29,306 - INFO - Initialized session with ID: f84c11ae-8c4f-46ef-86cd-d0ba7398e5ff
2024-07-12 19:22:29,307 - INFO - Asking question
2024-07-12 19:22:34,044 - INFO - Using session state variables...
2024-07-12 19:22:34,045 - INFO - ====== WebDriver manager ======
2024-07-12 19:22:34,302 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:22:34,365 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:22:34,427 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:22:35,090 - INFO - Session initialized with ID: 4ffdc7d2-bcd7-4fb8-ba7f-cb21cd853654
INFO:     127.0.0.1:58995 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:22:35,090 - INFO - Initialized session with ID: 4ffdc7d2-bcd7-4fb8-ba7f-cb21cd853654
2024-07-12 19:22:35,091 - INFO - Asking question
2024-07-12 19:22:35,091 - INFO - Question entered: hats
2024-07-12 19:22:35,093 - INFO - Received question: hats with session_id: 4ffdc7d2-bcd7-4fb8-ba7f-cb21cd853654
2024-07-12 19:22:35,093 - INFO - Current chat history for session_id 4ffdc7d2-bcd7-4fb8-ba7f-cb21cd853654: []
2024-07-12 19:22:35,093 - INFO - Processing question: hats
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:22:37,879 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:22:44,909 - INFO - chat_procesing: message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:22:44,909 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:22:44,909 - ERROR - Error processing chat question: object tuple can't be used in 'await' expression
2024-07-12 19:22:44,912 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 139, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

2024-07-12 19:22:44,912 - ERROR - Error in /ask_question: object tuple can't be used in 'await' expression
2024-07-12 19:22:44,912 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 101, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 139, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object tuple can't be used in 'await' expression

Time for extract_customer_attributes: 2.78498911857605
Time for split_process_and_message_from_response: 0.0003199577331542969
INFO:     127.0.0.1:58997 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 19:22:44,914 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:22:44.914 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [19083]
INFO:     Waiting for application startup.
2024-07-12 19:23:19,292 - INFO - Getting bedrock client...
2024-07-12 19:23:19,298 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:23:19,476 - INFO - Generating session state variables...
2024-07-12 19:23:19,476 - INFO - Getting bedrock client...
2024-07-12 19:23:19,481 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:23:19,580 - INFO - Initializing Bedrock...
2024-07-12 19:23:19,585 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:23:19,727 - INFO - Initializing Bedrock...
2024-07-12 19:23:19,731 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:23:19,828 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:23:19,828 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:23:19,828 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:23:19,855 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:23:19,855 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:23:19,866 - INFO - Documents file loaded successfully!
2024-07-12 19:23:19,866 - INFO - Structured documents created:
2024-07-12 19:23:19,866 - INFO - Document 1 of 3993:
2024-07-12 19:23:19,866 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:23:19,866 - INFO - Document 2 of 3993:
2024-07-12 19:23:19,866 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:23:19,866 - INFO - Document 3 of 3993:
2024-07-12 19:23:19,866 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:23:19,866 - INFO - Document 4 of 3993:
2024-07-12 19:23:19,866 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:23:19,866 - INFO - Document 5 of 3993:
2024-07-12 19:23:19,866 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:23:19,870 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:23:19,870 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:23:19,875 - INFO - Loading faiss.
2024-07-12 19:23:19,938 - INFO - Successfully loaded faiss.
2024-07-12 19:23:19,956 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:23:19,958 - INFO - ====== WebDriver manager ======
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:23:20,002 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:23:20,002 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:23:20,002 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:23:20,028 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:23:20,028 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:23:20,038 - INFO - Documents file loaded successfully!
2024-07-12 19:23:20,038 - INFO - Structured documents created:
2024-07-12 19:23:20,038 - INFO - Document 1 of 3993:
2024-07-12 19:23:20,038 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:23:20,038 - INFO - Document 2 of 3993:
2024-07-12 19:23:20,038 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:23:20,038 - INFO - Document 3 of 3993:
2024-07-12 19:23:20,038 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:23:20,038 - INFO - Document 4 of 3993:
2024-07-12 19:23:20,038 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:23:20,038 - INFO - Document 5 of 3993:
2024-07-12 19:23:20,038 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:23:20,043 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:23:20,043 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:23:20,047 - INFO - Loading faiss.
2024-07-12 19:23:20,057 - INFO - Successfully loaded faiss.
2024-07-12 19:23:20,132 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:23:20,134 - INFO - ====== WebDriver manager ======
2024-07-12 19:23:20,182 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:23:20,237 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:23:20,318 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:23:20,347 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:23:20,400 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:23:20,453 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:23:20,874 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:23:20,889 - INFO - Session initialized with ID: 4a6509bb-8b77-4e35-86df-1af77687cdc2
2024-07-12 19:23:20,889 - INFO - Initialized session with ID: 4a6509bb-8b77-4e35-86df-1af77687cdc2
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:59099 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:23:20,890 - INFO - Asking question
2024-07-12 19:23:26,126 - INFO - Using session state variables...
2024-07-12 19:23:26,126 - INFO - ====== WebDriver manager ======
2024-07-12 19:23:26,386 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:23:26,440 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:23:26,494 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:23:27,161 - INFO - Session initialized with ID: b5f6fd93-aa71-49a3-8d4e-ec123ded92ca
INFO:     127.0.0.1:59125 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:23:27,161 - INFO - Initialized session with ID: b5f6fd93-aa71-49a3-8d4e-ec123ded92ca
2024-07-12 19:23:27,162 - INFO - Asking question
2024-07-12 19:23:27,162 - INFO - Question entered: hats
2024-07-12 19:23:27,164 - INFO - Received question: hats with session_id: b5f6fd93-aa71-49a3-8d4e-ec123ded92ca
2024-07-12 19:23:27,164 - INFO - Current chat history for session_id b5f6fd93-aa71-49a3-8d4e-ec123ded92ca: []
2024-07-12 19:23:27,164 - INFO - Processing question: hats
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:23:29,183 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:23:36,250 - INFO - chat_procesing: message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:23:36,250 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:23:36,250 - INFO - Message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:23:36,250 - INFO - Response json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:23:36,250 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:23:36,250 - INFO - Time to get attributes: 2.0195720195770264
2024-07-12 19:23:36,250 - INFO - Updated chat history for session_id b5f6fd93-aa71-49a3-8d4e-ec123ded92ca: [[{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}], ["QUESTION: hats. MESSAGE: Here are the 2 baseball hats with their product descriptions and codes from the catalog:\n\n1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE\nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.\n\n1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  \nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:23:36,250 - INFO - Processed question: hats with message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:23:36,250 - INFO - Products retrieved: [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]
2024-07-12 19:23:36,250 - INFO - Fetching images for products: ['Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE']
2024-07-12 19:23:36,252 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:23:36,253 - INFO - Total time to fetch images: 0.0 seconds
2024-07-12 19:23:50,976 - INFO - Reviews for product 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:23:50,976 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:24:03,439 - INFO - Reviews for product 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:24:03,439 - INFO - Total time taken for ask_question: 36.27571201324463 seconds
2024-07-12 19:24:03,440 - ERROR - Error in /ask_question: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type
2024-07-12 19:24:03,443 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 117, in ask_question
    return ChatResponse(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/pydantic/main.py", line 193, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type

Time for extract_customer_attributes: 2.0189120769500732
Time for split_process_and_message_from_response: 0.00020694732666015625
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
INFO:     127.0.0.1:59127 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 19:24:03,443 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:24:03.444 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [19316]
INFO:     Waiting for application startup.
2024-07-12 19:24:34,945 - INFO - Getting bedrock client...
2024-07-12 19:24:34,951 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:24:34,972 - INFO - Generating session state variables...
2024-07-12 19:24:34,972 - INFO - Getting bedrock client...
2024-07-12 19:24:34,978 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:24:35,223 - INFO - Initializing Bedrock...
2024-07-12 19:24:35,227 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:24:35,234 - INFO - Initializing Bedrock...
2024-07-12 19:24:35,239 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:24:35,475 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:24:35,475 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:24:35,475 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:24:35,490 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:24:35,490 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:24:35,490 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:24:35,504 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:24:35,504 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:24:35,514 - INFO - Documents file loaded successfully!
2024-07-12 19:24:35,514 - INFO - Structured documents created:
2024-07-12 19:24:35,514 - INFO - Document 1 of 3993:
2024-07-12 19:24:35,514 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:24:35,514 - INFO - Document 2 of 3993:
2024-07-12 19:24:35,514 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:24:35,514 - INFO - Document 3 of 3993:
2024-07-12 19:24:35,514 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:24:35,514 - INFO - Document 4 of 3993:
2024-07-12 19:24:35,514 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:24:35,514 - INFO - Document 5 of 3993:
2024-07-12 19:24:35,514 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:24:35,515 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:24:35,515 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
2024-07-12 19:24:35,519 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:24:35,519 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:24:35,524 - INFO - Documents file loaded successfully!
2024-07-12 19:24:35,524 - INFO - Structured documents created:
2024-07-12 19:24:35,524 - INFO - Document 1 of 3993:
2024-07-12 19:24:35,524 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:24:35,524 - INFO - Document 2 of 3993:
2024-07-12 19:24:35,524 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:24:35,524 - INFO - Document 3 of 3993:
2024-07-12 19:24:35,524 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:24:35,524 - INFO - Document 4 of 3993:
2024-07-12 19:24:35,524 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:24:35,524 - INFO - Document 5 of 3993:
2024-07-12 19:24:35,524 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:24:35,525 - INFO - Loading faiss.
2024-07-12 19:24:35,529 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:24:35,529 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:24:35,533 - INFO - Loading faiss.
2024-07-12 19:24:35,544 - INFO - Successfully loaded faiss.
2024-07-12 19:24:35,594 - INFO - Successfully loaded faiss.
2024-07-12 19:24:35,612 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:24:35,614 - INFO - ====== WebDriver manager ======
2024-07-12 19:24:35,625 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:24:35,627 - INFO - ====== WebDriver manager ======
2024-07-12 19:24:35,808 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:24:35,808 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:24:35,868 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:24:35,868 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:24:35,919 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:24:35,919 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:24:36,490 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:24:36,505 - INFO - Session initialized with ID: 6c31c7bd-809c-4f20-af7d-30057cd44b46
2024-07-12 19:24:36,506 - INFO - Initialized session with ID: 6c31c7bd-809c-4f20-af7d-30057cd44b46
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:59335 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:24:36,506 - INFO - Asking question
2024-07-12 19:24:43,418 - INFO - Using session state variables...
2024-07-12 19:24:43,419 - INFO - ====== WebDriver manager ======
2024-07-12 19:24:43,674 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:24:43,735 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:24:43,785 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:24:44,461 - INFO - Session initialized with ID: 8823931d-4939-4cfe-aa83-4edc5eb3a4c0
INFO:     127.0.0.1:59366 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:24:44,462 - INFO - Initialized session with ID: 8823931d-4939-4cfe-aa83-4edc5eb3a4c0
2024-07-12 19:24:44,463 - INFO - Asking question
2024-07-12 19:24:44,463 - INFO - Question entered: hats for sun protection
2024-07-12 19:24:44,465 - INFO - Received question: hats for sun protection with session_id: 8823931d-4939-4cfe-aa83-4edc5eb3a4c0
2024-07-12 19:24:44,465 - INFO - Current chat history for session_id 8823931d-4939-4cfe-aa83-4edc5eb3a4c0: []
2024-07-12 19:24:44,465 - INFO - Processing question: hats for sun protection
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:24:46,725 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:24:55,329 - INFO - chat_procesing: message: Here are 4 hats that provide sun protection:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange 
1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green
2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange
2024-07-12 19:24:55,329 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}]}
2024-07-12 19:24:55,329 - INFO - Message: Here are 4 hats that provide sun protection:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange 
1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green
2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange
2024-07-12 19:24:55,329 - INFO - Response json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}]}
2024-07-12 19:24:55,329 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:24:55,329 - INFO - Time to get attributes: 2.259599208831787
2024-07-12 19:24:55,329 - INFO - Updated chat history for session_id 8823931d-4939-4cfe-aa83-4edc5eb3a4c0: [[{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}], ["QUESTION: hats for sun protection. MESSAGE: Here are 4 hats that provide sun protection:\n\n1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange \n1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green\n2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green\n2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:24:55,329 - INFO - Processed question: hats for sun protection with message: Here are 4 hats that provide sun protection:

1CXK5 - GLOWEAR BY ERGODYNE Baseball Cap: Orange 
1CXK6 - GLOWEAR BY ERGODYNE Baseball Cap: Green
2EMK4 - CHILL-ITS BY ERGODYNE Cooling Hat: Green
2EMK5 - CHILL-ITS BY ERGODYNE Cooling Hat: Orange
2024-07-12 19:24:55,329 - INFO - Products retrieved: [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '1CXK6'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK4'}, {'product': 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>', 'code': '2EMK5'}]
2024-07-12 19:24:55,329 - INFO - Fetching images for products: ['GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK5', 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK6', 'CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK4', 'CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK5']
2024-07-12 19:24:55,335 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK5
2024-07-12 19:24:55,468 - INFO - Total time to fetch images: 0.0033788681030273438 seconds
2024-07-12 19:25:07,782 - INFO - Reviews for product 1CXK5: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:25:07,782 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 1CXK6
2024-07-12 19:25:19,760 - INFO - Reviews for product 1CXK6: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:25:19,760 - INFO - Fetching reviews for product: CHILL-ITS BY ERGODYNE Cooling Hat: Green, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK4
2024-07-12 19:25:31,143 - INFO - Reviews for product 2EMK4: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 19:25:31,144 - INFO - Fetching reviews for product: CHILL-ITS BY ERGODYNE Cooling Hat: Orange, Universal, Cooling Hat with Neck Shade Hat, Cooling CHILL-ITS BY ERGODYNE <p>Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.</p>, 2EMK5
2024-07-12 19:25:42,391 - INFO - Reviews for product 2EMK5: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 19:25:42,392 - INFO - Total time taken for ask_question: 57.92621898651123 seconds
2024-07-12 19:25:42,392 - ERROR - Error in /ask_question: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type
2024-07-12 19:25:42,394 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 117, in ask_question
    return ChatResponse(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/pydantic/main.py", line 193, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type

Time for extract_customer_attributes: 2.2586240768432617
Time for split_process_and_message_from_response: 0.00016999244689941406
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK5_AS04?$lgmain$ for 1CXK5 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK6_AS06?$lgmain$ for 1CXK6 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/2EMK4_AS02?$lgmain$ for 2EMK4 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/2EMK5_AS02?$lgmain$ for 2EMK5 in 0.00 seconds
INFO:     127.0.0.1:59368 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
2024-07-12 19:25:42,395 - ERROR - Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:25:42.395 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 180, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 176, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 52, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 67, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 19:33:02.730 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1058, in _send_output
    self.send(msg)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 996, in send
    self.connect()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x104bb8950>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x104bb8950>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 114, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 27, in run
    self.initialize_session()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 14, in initialize_session
    response = requests.get("http://localhost:8000/initialize_session")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x104bb8950>: Failed to establish a new connection: [Errno 61] Connection refused'))
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [19819]
INFO:     Waiting for application startup.
2024-07-12 19:33:03,579 - INFO - Getting bedrock client...
2024-07-12 19:33:03,587 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:33:03,863 - INFO - Initializing Bedrock...
2024-07-12 19:33:03,868 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:33:04,111 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:33:04,111 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:33:04,111 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:33:04,142 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:33:04,142 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:33:04,153 - INFO - Documents file loaded successfully!
2024-07-12 19:33:04,153 - INFO - Structured documents created:
2024-07-12 19:33:04,153 - INFO - Document 1 of 3993:
2024-07-12 19:33:04,153 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:33:04,153 - INFO - Document 2 of 3993:
2024-07-12 19:33:04,153 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:33:04,153 - INFO - Document 3 of 3993:
2024-07-12 19:33:04,153 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:33:04,153 - INFO - Document 4 of 3993:
2024-07-12 19:33:04,153 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:33:04,153 - INFO - Document 5 of 3993:
2024-07-12 19:33:04,153 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:33:04,159 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:33:04,159 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:33:04,166 - INFO - Loading faiss.
2024-07-12 19:33:04,230 - INFO - Successfully loaded faiss.
2024-07-12 19:33:04,250 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:33:04,252 - INFO - ====== WebDriver manager ======
2024-07-12 19:33:04,499 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:33:04,560 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:33:04,611 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:33:05,305 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:60065 - "GET / HTTP/1.1" 200 OK
2024-07-12 19:33:56,296 - INFO - Session initialized with ID: 12eb5342-33bd-4510-8d5d-871141cb7ac0
INFO:     127.0.0.1:60110 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:34:07,308 - INFO - Session initialized with ID: 7922f0d7-79dd-4609-a2ad-fea30a220ccf
INFO:     127.0.0.1:60134 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:34:07,313 - INFO - Received question: Hats for sun protection with session_id: 7922f0d7-79dd-4609-a2ad-fea30a220ccf
2024-07-12 19:34:07,313 - INFO - Current chat history for session_id 7922f0d7-79dd-4609-a2ad-fea30a220ccf: []
2024-07-12 19:34:07,313 - INFO - Processing question: Hats for sun protection
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:34:09,466 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:34:15,848 - INFO - chat_procesing: message: Here are two sun protection hats from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:34:15,851 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6'}]}
2024-07-12 19:34:15,851 - INFO - Message: Here are two sun protection hats from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:34:15,851 - INFO - Response json: {'products': [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6'}]}
2024-07-12 19:34:15,851 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:34:15,851 - INFO - Time to get attributes: 2.1531081199645996
2024-07-12 19:34:15,851 - INFO - Updated chat history for session_id 7922f0d7-79dd-4609-a2ad-fea30a220ccf: [[{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6'}], ["QUESTION: Hats for sun protection. MESSAGE: Here are two sun protection hats from the catalog:\n\n1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.\n\n1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:34:15,851 - INFO - Processed question: Hats for sun protection with message: Here are two sun protection hats from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:34:15,851 - INFO - Products retrieved: [{'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5'}, {'product': 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6'}]
2024-07-12 19:34:15,852 - INFO - Fetching images for products: ['GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5', 'GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6']
2024-07-12 19:34:15,859 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5
2024-07-12 19:34:15,994 - INFO - Total time to fetch images: 0.003750324249267578 seconds
2024-07-12 19:34:28,722 - INFO - Reviews for product 1CXK5: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:34:28,722 - INFO - Fetching reviews for product: GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6
2024-07-12 19:34:39,749 - INFO - Reviews for product 1CXK6: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:34:39,749 - INFO - Total time taken for ask_question: 32.43630409240723 seconds
2024-07-12 19:34:39,749 - ERROR - Error in /ask_question: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type
2024-07-12 19:34:39,752 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 117, in ask_question
    return ChatResponse(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/pydantic/main.py", line 193, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChatResponse
customer_attributes_retrieved
  Input should be a valid dictionary [type=dict_type, input_value="{'Industry': 'Retail', '... False, 'Location': ''}", input_type=str]
    For further information visit https://errors.pydantic.dev/2.8/v/dict_type

Time for extract_customer_attributes: 2.151798963546753
Time for split_process_and_message_from_response: 0.00016832351684570312
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK5_AS04?$lgmain$ for 1CXK5 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK6_AS06?$lgmain$ for 1CXK6 in 0.00 seconds
INFO:     127.0.0.1:60136 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:34:39.753 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 114, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 32, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 46, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 19:36:39.836 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1058, in _send_output
    self.send(msg)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 996, in send
    self.connect()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1060a25d0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1060a25d0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 114, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 27, in run
    self.initialize_session()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 14, in initialize_session
    response = requests.get("http://localhost:8000/initialize_session")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1060a25d0>: Failed to establish a new connection: [Errno 61] Connection refused'))
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [20013]
INFO:     Waiting for application startup.
2024-07-12 19:36:40,920 - INFO - Getting bedrock client...
2024-07-12 19:36:40,928 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:36:41,194 - INFO - Initializing Bedrock...
2024-07-12 19:36:41,198 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:36:41,435 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:36:41,435 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:36:41,435 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:36:41,466 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:36:41,466 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:36:41,476 - INFO - Documents file loaded successfully!
2024-07-12 19:36:41,477 - INFO - Structured documents created:
2024-07-12 19:36:41,477 - INFO - Document 1 of 3993:
2024-07-12 19:36:41,477 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:36:41,477 - INFO - Document 2 of 3993:
2024-07-12 19:36:41,477 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:36:41,477 - INFO - Document 3 of 3993:
2024-07-12 19:36:41,477 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:36:41,477 - INFO - Document 4 of 3993:
2024-07-12 19:36:41,477 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:36:41,477 - INFO - Document 5 of 3993:
2024-07-12 19:36:41,477 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:36:41,481 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:36:41,481 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:36:41,489 - INFO - Loading faiss.
2024-07-12 19:36:41,559 - INFO - Successfully loaded faiss.
2024-07-12 19:36:41,579 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:36:41,580 - INFO - ====== WebDriver manager ======
2024-07-12 19:36:41,841 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:36:41,896 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:36:41,943 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:36:42,657 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:36:49,531 - INFO - Session initialized with ID: 5f83faa4-d3a2-4717-a5cc-071b432b99f3
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:60457 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:36:59,604 - INFO - Session initialized with ID: c7317ad1-8599-4dd6-94fa-e15551d0cb27
INFO:     127.0.0.1:60468 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:36:59,612 - INFO - Received question: hats for sun portection with session_id: c7317ad1-8599-4dd6-94fa-e15551d0cb27
2024-07-12 19:36:59,612 - INFO - Current chat history for session_id c7317ad1-8599-4dd6-94fa-e15551d0cb27: []
2024-07-12 19:36:59,612 - INFO - Processing question: hats for sun portection
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:37:02,079 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:37:07,584 - INFO - chat_procesing: message: Here are two hat options that can provide sun protection:

1CXK6 - Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose 
1CXK5 - Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose
2024-07-12 19:37:07,584 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}, {'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}]}
2024-07-12 19:37:07,584 - INFO - Message: Here are two hat options that can provide sun protection:

1CXK6 - Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose 
1CXK5 - Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose
2024-07-12 19:37:07,584 - INFO - Response json: {'products': [{'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}, {'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}]}
2024-07-12 19:37:07,585 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:37:07,585 - INFO - Time to get attributes: 2.4671847820281982
2024-07-12 19:37:07,585 - INFO - Updated chat history for session_id c7317ad1-8599-4dd6-94fa-e15551d0cb27: [[{'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}, {'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}], ["QUESTION: hats for sun portection. MESSAGE: Here are two hat options that can provide sun protection:\n\n1CXK6 - Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose \n1CXK5 - Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:37:07,585 - INFO - Processed question: hats for sun portection with message: Here are two hat options that can provide sun protection:

1CXK6 - Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose 
1CXK5 - Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose
2024-07-12 19:37:07,585 - INFO - Products retrieved: [{'product': 'Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK6'}, {'product': 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose', 'code': '1CXK5'}]
2024-07-12 19:37:07,585 - INFO - Fetching images for products: ['Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK6', 'Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK5']
2024-07-12 19:37:07,589 - INFO - Fetching reviews for product: Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK6
2024-07-12 19:37:08,235 - INFO - Total time to fetch images: 0.0019228458404541016 seconds
2024-07-12 19:37:19,564 - INFO - Reviews for product 1CXK6: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 19:37:19,564 - INFO - Fetching reviews for product: Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose, 1CXK5
2024-07-12 19:37:31,311 - INFO - Reviews for product 1CXK5: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Love it']}
2024-07-12 19:37:31,311 - INFO - Total time taken for ask_question: 31.699383020401 seconds
2024-07-12 19:37:31,311 - ERROR - Error in /ask_question: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
2024-07-12 19:37:31,314 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 122, in ask_question
    customer_attributes_retrieved=json.loads(customer_attributes_retrieved) if isinstance(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)

Time for extract_customer_attributes: 2.4657866954803467
Time for split_process_and_message_from_response: 0.00022459030151367188
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK6_AS06?$lgmain$ for 1CXK6 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/1CXK5_AS04?$lgmain$ for 1CXK5 in 0.00 seconds
INFO:     127.0.0.1:60470 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:37:31.316 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 114, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 32, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 46, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 19:38:51.721 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1058, in _send_output
    self.send(msg)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 996, in send
    self.connect()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x109b60050>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x109b60050>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 118, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 115, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 27, in run
    self.initialize_session()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 14, in initialize_session
    response = requests.get("http://localhost:8000/initialize_session")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x109b60050>: Failed to establish a new connection: [Errno 61] Connection refused'))
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [20134]
INFO:     Waiting for application startup.
2024-07-12 19:38:52,881 - INFO - Getting bedrock client...
2024-07-12 19:38:52,890 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:38:53,253 - INFO - Initializing Bedrock...
2024-07-12 19:38:53,263 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:38:53,569 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:38:53,569 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:38:53,569 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:38:53,618 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:38:53,618 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:38:53,635 - INFO - Documents file loaded successfully!
2024-07-12 19:38:53,635 - INFO - Structured documents created:
2024-07-12 19:38:53,635 - INFO - Document 1 of 3993:
2024-07-12 19:38:53,635 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:38:53,635 - INFO - Document 2 of 3993:
2024-07-12 19:38:53,635 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:38:53,635 - INFO - Document 3 of 3993:
2024-07-12 19:38:53,635 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:38:53,635 - INFO - Document 4 of 3993:
2024-07-12 19:38:53,635 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:38:53,635 - INFO - Document 5 of 3993:
2024-07-12 19:38:53,635 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:38:53,641 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:38:53,641 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:38:53,650 - INFO - Loading faiss.
2024-07-12 19:38:53,741 - INFO - Successfully loaded faiss.
2024-07-12 19:38:53,769 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:38:53,772 - INFO - ====== WebDriver manager ======
2024-07-12 19:38:54,096 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:38:54,180 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:38:54,241 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:38:54,873 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:38:57,256 - INFO - Session initialized with ID: 5ecb621a-c46a-4ba6-bc8d-93e7579a1404
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:60710 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:39:03,118 - INFO - Session initialized with ID: 4c07a0f8-620f-4202-addd-9a249e211abf
INFO:     127.0.0.1:60714 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:39:03,125 - INFO - Received question: hats with session_id: 4c07a0f8-620f-4202-addd-9a249e211abf
2024-07-12 19:39:03,125 - INFO - Current chat history for session_id 4c07a0f8-620f-4202-addd-9a249e211abf: []
2024-07-12 19:39:03,125 - INFO - Processing question: hats
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:39:05,340 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:39:12,334 - INFO - chat_procesing: message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:39:12,334 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:39:12,334 - INFO - Message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:39:12,334 - INFO - Response json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:39:12,334 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:39:12,334 - INFO - Time to get attributes: 2.2147216796875
2024-07-12 19:39:12,334 - INFO - Updated chat history for session_id 4c07a0f8-620f-4202-addd-9a249e211abf: [[{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}], ["QUESTION: hats. MESSAGE: Here are the 2 baseball hats with their product descriptions and codes from the catalog:\n\n1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE\nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.\n\n1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  \nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:39:12,334 - INFO - Processed question: hats with message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:39:12,334 - INFO - Products retrieved: [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]
2024-07-12 19:39:12,334 - INFO - Fetching images for products: ['Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE']
2024-07-12 19:39:12,335 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:39:12,336 - INFO - Total time to fetch images: 0.0 seconds
2024-07-12 19:39:52,612 - INFO - Reviews for product 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:39:52,613 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:40:04,034 - INFO - Reviews for product 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:40:04,034 - INFO - Total time taken for ask_question: 60.909127950668335 seconds
2024-07-12 19:40:04,035 - ERROR - Error in /ask_question: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
2024-07-12 19:40:04,037 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 122, in ask_question
    customer_attributes_retrieved=json.loads(customer_attributes_retrieved) if isinstance(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)

Time for extract_customer_attributes: 2.2131152153015137
Time for split_process_and_message_from_response: 0.00023603439331054688
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
INFO:     127.0.0.1:60716 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:40:04.039 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 118, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 115, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 32, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 47, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 19:52:47.317 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1058, in _send_output
    self.send(msg)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 996, in send
    self.connect()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10b5b53d0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10b5b53d0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 120, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 28, in run
    self.initialize_session()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 15, in initialize_session
    response = requests.get("http://localhost:8000/initialize_session")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10b5b53d0>: Failed to establish a new connection: [Errno 61] Connection refused'))
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [21049]
INFO:     Waiting for application startup.
2024-07-12 19:52:48,689 - INFO - Getting bedrock client...
2024-07-12 19:52:48,696 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:52:48,996 - INFO - Initializing Bedrock...
2024-07-12 19:52:49,002 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:52:49,267 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:52:49,267 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:52:49,267 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:52:49,299 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:52:49,299 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:52:49,312 - INFO - Documents file loaded successfully!
2024-07-12 19:52:49,312 - INFO - Structured documents created:
2024-07-12 19:52:49,312 - INFO - Document 1 of 3993:
2024-07-12 19:52:49,312 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:52:49,312 - INFO - Document 2 of 3993:
2024-07-12 19:52:49,312 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:52:49,312 - INFO - Document 3 of 3993:
2024-07-12 19:52:49,312 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:52:49,312 - INFO - Document 4 of 3993:
2024-07-12 19:52:49,312 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:52:49,312 - INFO - Document 5 of 3993:
2024-07-12 19:52:49,312 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:52:49,316 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:52:49,317 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:52:49,326 - INFO - Loading faiss.
2024-07-12 19:52:49,398 - INFO - Successfully loaded faiss.
2024-07-12 19:52:49,429 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:52:49,431 - INFO - ====== WebDriver manager ======
2024-07-12 19:52:49,627 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:52:49,684 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:52:49,759 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:52:50,323 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:52:51,762 - INFO - Session initialized with ID: 19e3b310-d8ae-45b0-b86d-ebbfaa8a4c36
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:61850 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:53:06,080 - INFO - Session initialized with ID: a01714e3-cb7e-4551-a315-ab19276bdf39
INFO:     127.0.0.1:61864 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:53:06,085 - INFO - Received question: hats with session_id: a01714e3-cb7e-4551-a315-ab19276bdf39
2024-07-12 19:53:06,085 - INFO - Current chat history for session_id a01714e3-cb7e-4551-a315-ab19276bdf39: []
2024-07-12 19:53:06,085 - INFO - Processing question: hats
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:53:07,901 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:53:14,718 - INFO - chat_procesing: message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:53:14,719 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:53:14,719 - INFO - Message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:53:14,719 - INFO - Response json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:53:14,719 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:53:14,719 - INFO - Time to get attributes: 1.815777063369751
2024-07-12 19:53:14,719 - INFO - Updated chat history for session_id a01714e3-cb7e-4551-a315-ab19276bdf39: [[{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}], ["QUESTION: hats. MESSAGE: Here are the 2 baseball hats with their product descriptions and codes from the catalog:\n\n1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE\nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.\n\n1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  \nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:53:14,719 - INFO - Processed question: hats with message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:53:14,719 - INFO - Products retrieved: [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]
2024-07-12 19:53:14,719 - INFO - Fetching images for products: ['Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE']
2024-07-12 19:53:14,720 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:53:14,721 - INFO - Total time to fetch images: 0.0 seconds
2024-07-12 19:53:29,555 - INFO - Reviews for product 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:53:29,555 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:53:41,086 - INFO - Reviews for product 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:53:41,087 - INFO - Total time taken for ask_question: 35.00130271911621 seconds
2024-07-12 19:53:41,087 - ERROR - Error in /ask_question: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
2024-07-12 19:53:41,090 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 122, in ask_question
    customer_attributes_retrieved=json.loads(customer_attributes_retrieved) if isinstance(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)

Time for extract_customer_attributes: 1.8141589164733887
Time for split_process_and_message_from_response: 0.00010085105895996094
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
INFO:     127.0.0.1:61866 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:53:41.091 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 120, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 33, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 48, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 19:57:29.197 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 196, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 495, in _make_request
    conn.request(
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 398, in request
    self.endheaders()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 1058, in _send_output
    self.send(msg)
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/http/client.py", line 996, in send
    self.connect()
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 236, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x128211b10>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x128211b10>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 120, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 28, in run
    self.initialize_session()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 15, in initialize_session
    response = requests.get("http://localhost:8000/initialize_session")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /initialize_session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x128211b10>: Failed to establish a new connection: [Errno 61] Connection refused'))
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [21426]
INFO:     Waiting for application startup.
2024-07-12 19:57:30,460 - INFO - Getting bedrock client...
2024-07-12 19:57:30,467 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 19:57:30,768 - INFO - Initializing Bedrock...
2024-07-12 19:57:30,773 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 19:57:31,034 - INFO - Initializing Titan Embeddings Model...
2024-07-12 19:57:31,034 - INFO - Titan Embeddings Model initialized.
2024-07-12 19:57:31,034 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 19:57:31,081 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 19:57:31,081 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 19:57:31,092 - INFO - Documents file loaded successfully!
2024-07-12 19:57:31,092 - INFO - Structured documents created:
2024-07-12 19:57:31,092 - INFO - Document 1 of 3993:
2024-07-12 19:57:31,092 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 19:57:31,092 - INFO - Document 2 of 3993:
2024-07-12 19:57:31,092 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 19:57:31,092 - INFO - Document 3 of 3993:
2024-07-12 19:57:31,092 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 19:57:31,092 - INFO - Document 4 of 3993:
2024-07-12 19:57:31,092 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 19:57:31,092 - INFO - Document 5 of 3993:
2024-07-12 19:57:31,092 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 19:57:31,097 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 19:57:31,097 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 19:57:31,103 - INFO - Loading faiss.
2024-07-12 19:57:31,169 - INFO - Successfully loaded faiss.
2024-07-12 19:57:31,187 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 19:57:31,189 - INFO - ====== WebDriver manager ======
2024-07-12 19:57:31,417 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:57:31,478 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 19:57:31,529 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache
2024-07-12 19:57:31,927 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 19:58:11,873 - INFO - Session initialized with ID: 2ad9cbae-469a-490f-b332-282fd6e0e2f3
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:62320 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:58:15,799 - INFO - Session initialized with ID: 29456bea-4f63-4b76-9935-9f1e2b516cb4
INFO:     127.0.0.1:62322 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 19:58:15,804 - INFO - Received question: hats with session_id: 29456bea-4f63-4b76-9935-9f1e2b516cb4
2024-07-12 19:58:15,804 - INFO - Current chat history for session_id 29456bea-4f63-4b76-9935-9f1e2b516cb4: []
2024-07-12 19:58:15,804 - INFO - Processing question: hats
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:58:17,900 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 19:58:24,909 - INFO - chat_procesing: message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:58:24,909 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:58:24,909 - INFO - Message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:58:24,909 - INFO - Response json: {'products': [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]}
2024-07-12 19:58:24,909 - INFO - Customer attributes retrieved: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 19:58:24,909 - INFO - Time to get attributes: 2.0963001251220703
2024-07-12 19:58:24,909 - INFO - Updated chat history for session_id 29456bea-4f63-4b76-9935-9f1e2b516cb4: [[{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}], ["QUESTION: hats. MESSAGE: Here are the 2 baseball hats with their product descriptions and codes from the catalog:\n\n1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE\nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.\n\n1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  \nBaseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.. CUSTOMER ATTRIBUTES: {'Industry': 'Retail', 'Size': 'Small Businesses', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 19:58:24,909 - INFO - Processed question: hats with message: Here are the 2 baseball hats with their product descriptions and codes from the catalog:

1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.

1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE  
Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:58:24,909 - INFO - Products retrieved: [{'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}, {'product': 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.', 'code': '1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE'}]
2024-07-12 19:58:24,909 - INFO - Fetching images for products: ['Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE', 'Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE']
2024-07-12 19:58:24,909 - INFO - grainger_image_util item.part[-1]: Gen Purpose GLOWEAR BY ERGODYNE. item.part[0]: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:58:24,913 - INFO - grainger_image_util item.part[-1]: Gen Purpose GLOWEAR BY ERGODYNE. item.part[0]: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility.
2024-07-12 19:58:24,913 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:58:24,916 - INFO - Total time to fetch images: 0.0 seconds
2024-07-12 19:58:36,927 - INFO - Reviews for product 1CXK5 GLOWEAR BY ERGODYNE Baseball Cap: Orange, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:58:36,927 - INFO - Fetching reviews for product: Baseball hats have a curved brim that shades the eyes from sun to reduce eye strain and improve visibility., 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE
2024-07-12 19:58:47,341 - INFO - Reviews for product 1CXK6 GLOWEAR BY ERGODYNE Baseball Cap: Green, Universal, Baseball Hat Hat, Polyester, Gen Purpose GLOWEAR BY ERGODYNE: {'Average Star Rating': 5.0, 'Average Recommendation Percent': 100.0, 'Review Texts': ["This Cap is perfect for Hunting Season up heah' in Aroostook even if you don't hunt. It can be seen from way off yonder expecially with the reflective inserts", 'This has is Perfect for this time of year in Maine during Hunting Season. It if not only Bright & easily seen, but also Reflective and the Price is very reasonable.']}
2024-07-12 19:58:47,341 - INFO - Total time taken for ask_question: 31.537078857421875 seconds
2024-07-12 19:58:47,341 - ERROR - Error in /ask_question: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
2024-07-12 19:58:47,343 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 122, in ask_question
    customer_attributes_retrieved=json.loads(customer_attributes_retrieved) if isinstance(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)

Time for extract_customer_attributes: 2.09525203704834
Time for split_process_and_message_from_response: 0.0001270771026611328
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
Code Gen Purpose GLOWEAR BY ERGODYNE not found in the dataframe.
INFO:     127.0.0.1:62324 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 19:58:47.345 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 120, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 33, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 48, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [23127]
INFO:     Waiting for application startup.
2024-07-12 20:03:06,409 - INFO - Getting bedrock client...
2024-07-12 20:03:06,415 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 20:03:06,675 - INFO - Initializing Bedrock...
2024-07-12 20:03:06,680 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 20:03:06,921 - INFO - Initializing Titan Embeddings Model...
2024-07-12 20:03:06,921 - INFO - Titan Embeddings Model initialized.
2024-07-12 20:03:06,921 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 20:03:06,951 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 20:03:06,951 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 20:03:06,962 - INFO - Documents file loaded successfully!
2024-07-12 20:03:06,962 - INFO - Structured documents created:
2024-07-12 20:03:06,962 - INFO - Document 1 of 3993:
2024-07-12 20:03:06,962 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 20:03:06,962 - INFO - Document 2 of 3993:
2024-07-12 20:03:06,963 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 20:03:06,963 - INFO - Document 3 of 3993:
2024-07-12 20:03:06,963 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 20:03:06,963 - INFO - Document 4 of 3993:
2024-07-12 20:03:06,963 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 20:03:06,963 - INFO - Document 5 of 3993:
2024-07-12 20:03:06,963 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 20:03:06,966 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 20:03:06,966 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 20:03:06,972 - INFO - Loading faiss.
2024-07-12 20:03:07,031 - INFO - Successfully loaded faiss.
2024-07-12 20:03:07,060 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 20:03:07,062 - INFO - ====== WebDriver manager ======
2024-07-12 20:03:07,304 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:03:07,357 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:03:07,413 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 20:03:08,110 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 20:03:08,581 - INFO - Session initialized with ID: 20b7af03-cfef-470b-913c-9050091cc136
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:62818 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:03:19,643 - INFO - Session initialized with ID: 19aba4c2-0b1d-400c-9408-89a4e9483f54
INFO:     127.0.0.1:62833 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:03:19,649 - INFO - Received question: work boots waterproof with session_id: 19aba4c2-0b1d-400c-9408-89a4e9483f54
2024-07-12 20:03:19,649 - INFO - Current chat history for session_id 19aba4c2-0b1d-400c-9408-89a4e9483f54: []
2024-07-12 20:03:19,649 - INFO - Processing question: work boots waterproof
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:03:21,673 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:03:35,799 - INFO - chat_procesing: message: Here are the waterproof work boots available from the catalog:
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A646)  
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A647)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A645)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A648)  
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A644)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A649)
2024-07-12 20:03:35,799 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A646'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A647'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A645'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A648'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A644'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A649'}]}
2024-07-12 20:03:35,799 - INFO - Message: Here are the waterproof work boots available from the catalog:
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A646)  
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A647)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A645)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A648)  
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A644)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A649)
2024-07-12 20:03:35,799 - INFO - Response json: {'products': [{'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A646'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A647'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A645'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A648'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A644'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A649'}]}
2024-07-12 20:03:35,799 - INFO - Customer attributes retrieved: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 20:03:35,799 - INFO - Time to get attributes: 2.0245440006256104
2024-07-12 20:03:35,799 - INFO - Updated chat history for session_id 19aba4c2-0b1d-400c-9408-89a4e9483f54: [[{'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A646'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A647'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A645'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A648'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A644'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A649'}], ["QUESTION: work boots waterproof. MESSAGE: Here are the waterproof work boots available from the catalog:\n- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A646)  \n- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A647)\n- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A645)\n- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A648)  \n- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A644)\n- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A649). CUSTOMER ATTRIBUTES: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 20:03:35,799 - INFO - Processed question: work boots waterproof with message: Here are the waterproof work boots available from the catalog:
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A646)  
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A647)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A645)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A648)  
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A644)
- Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO. (Code: 21A649)
2024-07-12 20:03:35,799 - INFO - Products retrieved: [{'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A646'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A647'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A645'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A648'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A644'}, {'product': 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO.', 'code': '21A649'}]
2024-07-12 20:03:35,800 - INFO - Fetching images for products: ['Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO., 21A646', 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO., 21A647', 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO., 21A645', 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO., 21A648', 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO., 21A644', 'Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO., 21A649']
2024-07-12 20:03:35,800 - INFO - grainger_image_util item.part[-1]: 21A646. item.part[0]: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof
2024-07-12 20:03:35,801 - INFO - grainger_image_util item.part[-1]: 21A647. item.part[0]: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof
2024-07-12 20:03:35,802 - INFO - grainger_image_util item.part[-1]: 21A645. item.part[0]: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof
2024-07-12 20:03:35,802 - INFO - grainger_image_util item.part[-1]: 21A648. item.part[0]: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof
2024-07-12 20:03:35,802 - INFO - grainger_image_util item.part[-1]: 21A644. item.part[0]: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof
2024-07-12 20:03:35,803 - INFO - grainger_image_util item.part[-1]: 21A649. item.part[0]: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof
2024-07-12 20:03:35,803 - INFO - Fetching reviews for product: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 7, 1 PR THE ORIGINAL MUCK BOOT CO., 21A646
2024-07-12 20:03:36,492 - INFO - Total time to fetch images: 0.0023660659790039062 seconds
2024-07-12 20:03:51,434 - INFO - Reviews for product 21A646: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 20:03:51,434 - INFO - Fetching reviews for product: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 8, 1 PR THE ORIGINAL MUCK BOOT CO., 21A647
2024-07-12 20:04:04,833 - INFO - Reviews for product 21A647: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 20:04:04,833 - INFO - Fetching reviews for product: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 6, 1 PR THE ORIGINAL MUCK BOOT CO., 21A645
2024-07-12 20:04:17,934 - INFO - Reviews for product 21A645: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 20:04:17,935 - INFO - Fetching reviews for product: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 9, 1 PR THE ORIGINAL MUCK BOOT CO., 21A648
2024-07-12 20:04:30,617 - INFO - Reviews for product 21A648: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 20:04:30,617 - INFO - Fetching reviews for product: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 5, 1 PR THE ORIGINAL MUCK BOOT CO., 21A644
2024-07-12 20:04:43,237 - INFO - Reviews for product 21A644: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 20:04:43,237 - INFO - Fetching reviews for product: Rubber Boot: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, 10, 1 PR THE ORIGINAL MUCK BOOT CO., 21A649
2024-07-12 20:04:56,499 - INFO - Reviews for product 21A649: {'Average Star Rating': None, 'Average Recommendation Percent': None, 'Review Texts': []}
2024-07-12 20:04:56,499 - INFO - Total time taken for ask_question: 96.8507719039917 seconds
2024-07-12 20:04:56,500 - ERROR - Error in /ask_question: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
2024-07-12 20:04:56,501 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 122, in ask_question
    customer_attributes_retrieved=json.loads(customer_attributes_retrieved) if isinstance(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)

Time for extract_customer_attributes: 2.0233678817749023
Time for split_process_and_message_from_response: 0.00011897087097167969
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A646 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A647 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A645 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A648 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A644 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A649 in 0.00 seconds
INFO:     127.0.0.1:62835 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
2024-07-12 20:04:56.503 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 120, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 117, in main
    interface.run()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 33, in run
    asyncio.run(self.ask_question(main_column, side_column))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 48, in ask_question
    products = response_json.get('products', [])
               ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [23927]
INFO:     Waiting for application startup.
2024-07-12 20:17:55,790 - INFO - Getting bedrock client...
2024-07-12 20:17:55,797 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 20:17:56,088 - INFO - Initializing Bedrock...
2024-07-12 20:17:56,093 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 20:17:56,339 - INFO - Initializing Titan Embeddings Model...
2024-07-12 20:17:56,339 - INFO - Titan Embeddings Model initialized.
2024-07-12 20:17:56,339 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 20:17:56,371 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 20:17:56,371 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 20:17:56,382 - INFO - Documents file loaded successfully!
2024-07-12 20:17:56,382 - INFO - Structured documents created:
2024-07-12 20:17:56,382 - INFO - Document 1 of 3993:
2024-07-12 20:17:56,382 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 20:17:56,382 - INFO - Document 2 of 3993:
2024-07-12 20:17:56,382 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 20:17:56,382 - INFO - Document 3 of 3993:
2024-07-12 20:17:56,382 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 20:17:56,382 - INFO - Document 4 of 3993:
2024-07-12 20:17:56,382 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 20:17:56,382 - INFO - Document 5 of 3993:
2024-07-12 20:17:56,382 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 20:17:56,387 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 20:17:56,387 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 20:17:56,394 - INFO - Loading faiss.
2024-07-12 20:17:56,455 - INFO - Successfully loaded faiss.
2024-07-12 20:17:56,472 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 20:17:56,474 - INFO - ====== WebDriver manager ======
2024-07-12 20:17:56,698 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:17:56,751 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:17:56,801 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 20:17:57,505 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 20:17:57.773 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 163, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 146, in main
    bedrock_embeddings, vectorstore_faiss_doc, df, llm = initialize_embeddings_and_faiss()
                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'initialize_embeddings_and_faiss' is not defined
2024-07-12 20:17:58.373 Uncaught app exception
Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 589, in _run_script
    exec(code, module.__dict__)
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 163, in <module>
    main()
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/streamlit_ui.py", line 146, in main
    bedrock_embeddings, vectorstore_faiss_doc, df, llm = initialize_embeddings_and_faiss()
                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'initialize_embeddings_and_faiss' is not defined
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [24365]
INFO:     Waiting for application startup.
2024-07-12 20:25:10,307 - INFO - Getting bedrock client...
2024-07-12 20:25:10,313 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 20:25:10,568 - INFO - Initializing Bedrock...
2024-07-12 20:25:10,573 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 20:25:10,827 - INFO - Initializing Titan Embeddings Model...
2024-07-12 20:25:10,827 - INFO - Titan Embeddings Model initialized.
2024-07-12 20:25:10,827 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 20:25:10,857 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 20:25:10,857 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 20:25:10,869 - INFO - Documents file loaded successfully!
2024-07-12 20:25:10,869 - INFO - Structured documents created:
2024-07-12 20:25:10,869 - INFO - Document 1 of 3993:
2024-07-12 20:25:10,869 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 20:25:10,869 - INFO - Document 2 of 3993:
2024-07-12 20:25:10,869 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 20:25:10,869 - INFO - Document 3 of 3993:
2024-07-12 20:25:10,869 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 20:25:10,869 - INFO - Document 4 of 3993:
2024-07-12 20:25:10,869 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 20:25:10,869 - INFO - Document 5 of 3993:
2024-07-12 20:25:10,869 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 20:25:10,874 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 20:25:10,874 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 20:25:10,880 - INFO - Loading faiss.
2024-07-12 20:25:10,961 - INFO - Successfully loaded faiss.
2024-07-12 20:25:10,982 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 20:25:10,984 - INFO - ====== WebDriver manager ======
2024-07-12 20:25:11,239 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:25:11,292 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:25:11,343 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 20:25:12,071 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 20:25:12,514 - INFO - fast_api_main/ Session initialized with ID: ed0aa45e-faa0-4964-9312-1a39ee2647a1
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:64492 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:25:22,027 - INFO - fast_api_main/ Session initialized with ID: 037f9313-8ce6-4560-9e2e-23b1320a9554
INFO:     127.0.0.1:64516 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:25:22,030 - INFO - fast_api_main/ Received question: waterproof boots with session_id: 037f9313-8ce6-4560-9e2e-23b1320a9554
2024-07-12 20:25:22,030 - INFO - fast_api_main/ Current chat history for session_id 037f9313-8ce6-4560-9e2e-23b1320a9554: []
2024-07-12 20:25:22,030 - INFO - fast_api_main/ Processing question: waterproof boots
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:25:24,626 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:25:45,684 - INFO - chat_procesing: message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:25:45,684 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]}
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Response json: {'products': [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]}
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Customer attributes retrieved: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Time to get attributes: 2.5960230827331543
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Updated chat history for session_id 037f9313-8ce6-4560-9e2e-23b1320a9554: [[{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}], ["QUESTION: waterproof boots. MESSAGE: Here are the waterproof boots available:\n- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  \n- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.. CUSTOMER ATTRIBUTES: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Processed question: waterproof boots with message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Products retrieved: [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]
2024-07-12 20:25:45,684 - INFO - fast_api_main/ Fetching images for products: ['These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT14', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT15', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT13', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT12', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GU61', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 21A646']
2024-07-12 20:25:45,684 - INFO - grainger_image_util item.part[-1]: 35GT14 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:25:45,686 - INFO - grainger_image_util item.part[-1]: 35GT15 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:25:45,686 - INFO - grainger_image_util item.part[-1]: 35GT13 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:25:45,686 - INFO - grainger_image_util item.part[-1]: 35GT12 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:25:45,686 - INFO - grainger_image_util item.part[-1]: 35GU61 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:25:45,687 - INFO - grainger_image_util item.part[-1]: 21A646 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:25:45,687 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT14
2024-07-12 20:25:46,107 - INFO - fast_api_main/ Total time to fetch images: 0.001710653305053711 seconds
2024-07-12 20:26:00,225 - INFO - fast_api_main/ Reviews for product 35GT14: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:26:00,225 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT15
2024-07-12 20:26:12,127 - INFO - fast_api_main/ Reviews for product 35GT15: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:26:12,127 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT13
2024-07-12 20:26:25,788 - INFO - fast_api_main/ Reviews for product 35GT13: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:26:25,788 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT12
2024-07-12 20:26:37,690 - INFO - fast_api_main/ Reviews for product 35GT12: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:26:37,690 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GU61
2024-07-12 20:26:50,688 - INFO - fast_api_main/ Reviews for product 35GU61: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:26:50,688 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 21A646
2024-07-12 20:27:02,091 - INFO - fast_api_main/ Reviews for product 21A646: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:27:02,091 - INFO - fast_api_main/ Total time taken for ask_question: 100.06137800216675 seconds
2024-07-12 20:27:02,092 - ERROR - Error in /ask_question: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
2024-07-12 20:27:02,095 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 123, in ask_question
    customer_attributes_retrieved=json.loads(customer_attributes_retrieved) if isinstance(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)

Time for extract_customer_attributes: 2.594660997390747
Time for split_process_and_message_from_response: 9.083747863769531e-05
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT14 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT15 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT13 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT12 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GU61 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A646 in 0.00 seconds
INFO:     127.0.0.1:64518 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
ERROR:root:Received None response_json from FastAPI
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [24973]
INFO:     Waiting for application startup.
2024-07-12 20:37:03,930 - INFO - Getting bedrock client...
2024-07-12 20:37:03,937 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 20:37:04,214 - INFO - Initializing Bedrock...
2024-07-12 20:37:04,220 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 20:37:04,460 - INFO - Initializing Titan Embeddings Model...
2024-07-12 20:37:04,460 - INFO - Titan Embeddings Model initialized.
2024-07-12 20:37:04,461 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 20:37:04,492 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 20:37:04,492 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 20:37:04,504 - INFO - Documents file loaded successfully!
2024-07-12 20:37:04,504 - INFO - Structured documents created:
2024-07-12 20:37:04,504 - INFO - Document 1 of 3993:
2024-07-12 20:37:04,504 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 20:37:04,504 - INFO - Document 2 of 3993:
2024-07-12 20:37:04,504 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 20:37:04,504 - INFO - Document 3 of 3993:
2024-07-12 20:37:04,504 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 20:37:04,504 - INFO - Document 4 of 3993:
2024-07-12 20:37:04,504 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 20:37:04,504 - INFO - Document 5 of 3993:
2024-07-12 20:37:04,504 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 20:37:04,509 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 20:37:04,509 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 20:37:04,516 - INFO - Loading faiss.
2024-07-12 20:37:04,592 - INFO - Successfully loaded faiss.
2024-07-12 20:37:04,610 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 20:37:04,612 - INFO - ====== WebDriver manager ======
2024-07-12 20:37:04,845 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:37:04,895 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:37:04,952 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 20:37:05,692 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 20:37:05,998 - INFO - fast_api_main/ Session initialized with ID: ee31e1a7-7c31-4534-82b0-3d9538401285
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:65422 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:37:13,192 - INFO - fast_api_main/ Session initialized with ID: 11fc62b0-5046-46d5-988e-acaf3fe5aad4
INFO:     127.0.0.1:65436 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:37:13,196 - INFO - fast_api_main/ Received question: waterproof boots with session_id: 11fc62b0-5046-46d5-988e-acaf3fe5aad4
2024-07-12 20:37:13,196 - INFO - fast_api_main/ Current chat history for session_id 11fc62b0-5046-46d5-988e-acaf3fe5aad4: []
2024-07-12 20:37:13,196 - INFO - fast_api_main/ Processing question: waterproof boots
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:37:15,546 - INFO - Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:37:39,603 - INFO - chat_procesing: message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:37:39,603 - INFO - chat_procesing: product_list_as_json: {'products': [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]}
2024-07-12 20:37:39,603 - ERROR - Error processing chat question: the JSON object must be str, bytes or bytearray, not dict
2024-07-12 20:37:39,606 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 146, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/chat_processor.py", line 58, in process_chat_question_with_customer_attribute_identifier
    product_list_as_json = json.loads(product_list_as_json)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '
TypeError: the JSON object must be str, bytes or bytearray, not dict

2024-07-12 20:37:39,606 - ERROR - Error in fast_api_main/ask_question: the JSON object must be str, bytes or bytearray, not dict
2024-07-12 20:37:39,606 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 96, in ask_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = await process_chat_question(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 146, in process_chat_question
    message, response_json, customer_attributes_retrieved, time_to_get_attributes = process_chat_question_with_customer_attribute_identifier(
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/chat_processor.py", line 58, in process_chat_question_with_customer_attribute_identifier
    product_list_as_json = json.loads(product_list_as_json)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '
TypeError: the JSON object must be str, bytes or bytearray, not dict

Time for extract_customer_attributes: 2.3485910892486572
Time for split_process_and_message_from_response: 0.00011587142944335938
INFO:     127.0.0.1:65438 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
ERROR:root:Received None response_json from FastAPI
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
INFO:     Started server process [25265]
INFO:     Waiting for application startup.
2024-07-12 20:43:27,843 - INFO - Getting bedrock client...
2024-07-12 20:43:27,850 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2024-07-12 20:43:28,113 - INFO - Initializing Bedrock...
2024-07-12 20:43:28,118 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The class `Bedrock` was deprecated in LangChain 0.1.0 and will be removed in 0.2.0. Use BedrockLLM instead.
  warn_deprecated(
2024-07-12 20:43:28,366 - INFO - Initializing Titan Embeddings Model...
2024-07-12 20:43:28,366 - INFO - Titan Embeddings Model initialized.
2024-07-12 20:43:28,366 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/processed/grainger_products.parquet
2024-07-12 20:43:28,397 - INFO - Attempting to load file from: /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl
2024-07-12 20:43:28,397 - INFO - Serialized documents file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/data_source/documents.pkl already exists. Loading...
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing BedrockEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import BedrockEmbeddings

with new imports of:

>> from langchain_community.embeddings import BedrockEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing FAISS from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import FAISS

with new imports of:

>> from langchain_community.vectorstores import FAISS
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain/_api/module_import.py:92: LangChainDeprecationWarning: Importing Bedrock from langchain.llms is deprecated. Please replace deprecated imports:

>> from langchain.llms import Bedrock

with new imports of:

>> from langchain_community.llms import Bedrock
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/v0.2/docs/versions/v0_2/>
  warn_deprecated(
2024-07-12 20:43:28,408 - INFO - Documents file loaded successfully!
2024-07-12 20:43:28,408 - INFO - Structured documents created:
2024-07-12 20:43:28,408 - INFO - Document 1 of 3993:
2024-07-12 20:43:28,408 - INFO - 52WX73 Handheld Tape Dispenser: Light, For 3 in Max Tape Wd, For 3 in Tape Core Dia, Pistol APPROVED VENDOR <p>Handheld packaging tape dispensers hold a roll of self-adhesive packaging tape and have a
2024-07-12 20:43:28,408 - INFO - Document 2 of 3993:
2024-07-12 20:43:28,408 - INFO - 8ZF81 Humidity Sponge Indicator: 3 in Wd, 3 in Lg, 476 cu in Area Protected, Bag, 40 Bags per Pack, 40 PK CONTROL COMPANY <p>Tyvek-brand desiccant bags are tear-proof and dust-free and meet FDA specif
2024-07-12 20:43:28,408 - INFO - Document 3 of 3993:
2024-07-12 20:43:28,408 - INFO - 8X316 TIMBERLAND PRO Work Boot: W, 11 1/2, 6 in Work Boot Footwear, Men's, Wheat, 1 PR TIMBERLAND PRO 
2024-07-12 20:43:28,408 - INFO - Document 4 of 3993:
2024-07-12 20:43:28,408 - INFO - 31XL69 TPI CORP. Electric Wall & Ceiling Unit Heater: 208/240V AC, 1-phase, 11 in x 10-5/8 in x 9-5/8 in TPI CORP. <p>Standard suspended electric wall and ceiling unit heaters hang from a bracket or t
2024-07-12 20:43:28,408 - INFO - Document 5 of 3993:
2024-07-12 20:43:28,408 - INFO - 6FHC0 Traffic Cone: Day or Low Speed Roadway (40 MPH or Less), Non-Reflective, Black Base, 28 in Cone Ht APPROVED VENDOR <p>These traffic cones meet federal MUTCD (Manual on Uniform Traffic Control De
2024-07-12 20:43:28,412 - INFO - Serialized index file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl
2024-07-12 20:43:28,412 - INFO - Serialized file /Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/vector_index/vector_index.pkl already exists. Loading...
2024-07-12 20:43:28,419 - INFO - Loading faiss.
2024-07-12 20:43:28,484 - INFO - Successfully loaded faiss.
2024-07-12 20:43:28,503 - INFO - FAISS vector store loaded from pickle file.
2024-07-12 20:43:28,505 - INFO - ====== WebDriver manager ======
2024-07-12 20:43:28,750 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:43:28,807 - INFO - Get LATEST chromedriver version for google-chrome
2024-07-12 20:43:28,875 - INFO - Driver [/Users/xnxn040/.wdm/drivers/chromedriver/mac64/126.0.6478.126/chromedriver-mac-arm64/chromedriver] found in cache

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8505
  Network URL: http://10.52.150.95:8505

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
2024-07-12 20:43:29,473 - INFO - Startup complete.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2024-07-12 20:43:29,829 - INFO - fast_api_main/ Session initialized with ID: 9a0a5d82-a790-4574-92b5-266136eaef40
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock(https://bedrock.us-east-1.amazonaws.com)
Create new client
  Using region: None
  Using role: arn:aws:iam::905418421511:role/service-role/AmazonSageMaker-ExecutionRole-20240623T114364 ... successful!
boto3 Bedrock client successfully created!
bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO:     127.0.0.1:49514 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:43:37,574 - INFO - fast_api_main/ Session initialized with ID: 8b83b319-f722-4589-b023-2e1b555605a9
INFO:     127.0.0.1:49531 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:43:37,599 - INFO - fast_api_main/ Received question: waterproof boots with session_id: 8b83b319-f722-4589-b023-2e1b555605a9
2024-07-12 20:43:37,599 - INFO - fast_api_main/ Current chat history for session_id 8b83b319-f722-4589-b023-2e1b555605a9: []
2024-07-12 20:43:37,599 - INFO - fast_api_main/ Processing question: waterproof boots
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:43:39,845 - INFO - chat_processor/ Chat History passed to processor: []
/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:139: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use invoke instead.
  warn_deprecated(
2024-07-12 20:44:04,217 - INFO - chat_processor/ chat_procesing: message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:44:04,217 - INFO - chat_processor/ chat_procesing: product_list_as_json: {'products': [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]}
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Response json: {'products': [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]}
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Customer attributes retrieved: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Time to get attributes: 2.2463598251342773
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Updated chat history for session_id 8b83b319-f722-4589-b023-2e1b555605a9: [[{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}], ["QUESTION: waterproof boots. MESSAGE: Here are the waterproof boots available:\n- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  \n- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.. CUSTOMER ATTRIBUTES: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Processed question: waterproof boots with message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Products retrieved: [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]
2024-07-12 20:44:04,217 - INFO - fast_api_main/ Fetching images for products: ['These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT14', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT15', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT13', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT12', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GU61', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 21A646']
2024-07-12 20:44:04,217 - INFO - grainger_image_util item.part[-1]: 35GT14 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:04,218 - INFO - grainger_image_util item.part[-1]: 35GT15 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:04,219 - INFO - grainger_image_util item.part[-1]: 35GT13 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:04,219 - INFO - grainger_image_util item.part[-1]: 35GT12 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:04,219 - INFO - grainger_image_util item.part[-1]: 35GU61 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:04,220 - INFO - grainger_image_util item.part[-1]: 21A646 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:04,220 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT14
2024-07-12 20:44:04,238 - INFO - fast_api_main/ Session initialized with ID: 232c4f7a-9e36-4c57-bb5f-a60cc7b21295
Time for extract_customer_attributes: 2.245368003845215
Time for split_process_and_message_from_response: 9.393692016601562e-05
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT14 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT15 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT13 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT12 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GU61 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A646 in 0.00 seconds
INFO:     127.0.0.1:49536 - "GET /initialize_session HTTP/1.1" 200 OK
2024-07-12 20:44:04,241 - INFO - fast_api_main/ Received question: waterproof boots with session_id: 232c4f7a-9e36-4c57-bb5f-a60cc7b21295
2024-07-12 20:44:04,241 - INFO - fast_api_main/ Current chat history for session_id 232c4f7a-9e36-4c57-bb5f-a60cc7b21295: []
2024-07-12 20:44:04,241 - INFO - fast_api_main/ Processing question: waterproof boots
2024-07-12 20:44:06,570 - INFO - chat_processor/ Chat History passed to processor: []
2024-07-12 20:44:35,051 - INFO - chat_processor/ chat_procesing: message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:44:35,051 - INFO - chat_processor/ chat_procesing: product_list_as_json: {'products': [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]}
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Response json: {'products': [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]}
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Customer attributes retrieved: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Time to get attributes: 2.328845739364624
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Updated chat history for session_id 232c4f7a-9e36-4c57-bb5f-a60cc7b21295: [[{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}], ["QUESTION: waterproof boots. MESSAGE: Here are the waterproof boots available:\n- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  \n- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE\n- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.. CUSTOMER ATTRIBUTES: {'Industry': 'Other', 'Size': 'Individual Customer', 'SustainabilityFocus': False, 'InventoryManager': False, 'Location': ''}"]]
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Processed question: waterproof boots with message: Here are the waterproof boots available:
- Rubber Boot 35GT14: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT15: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE  
- Rubber Boot 35GT13: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GT12: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 35GU61: Rigid Fiberglass, Rubber/Rubber Over Neoprene, Black, LACROSSE
- Rubber Boot 21A646: Cold-Insulated/Electrical Hazard (EH)/Oil-Resistant Sole/Plain Toe/Waterproof, THE ORIGINAL MUCK BOOT CO.
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Products retrieved: [{'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT14'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT15'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT13'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GT12'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '35GU61'}, {'product': 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures.', 'code': '21A646'}]
2024-07-12 20:44:35,051 - INFO - fast_api_main/ Fetching images for products: ['These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT14', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT15', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT13', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT12', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GU61', 'These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 21A646']
2024-07-12 20:44:35,051 - INFO - grainger_image_util item.part[-1]: 35GT14 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:35,052 - INFO - grainger_image_util item.part[-1]: 35GT15 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:35,052 - INFO - grainger_image_util item.part[-1]: 35GT13 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:35,052 - INFO - grainger_image_util item.part[-1]: 35GT12 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:35,052 - INFO - grainger_image_util item.part[-1]: 35GU61 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:35,053 - INFO - grainger_image_util item.part[-1]: 21A646 item.part[0]: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug
2024-07-12 20:44:35,053 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT14
2024-07-12 20:44:35,262 - INFO - fast_api_main/ Total time to fetch images: 0.0018079280853271484 seconds
2024-07-12 20:44:35,635 - INFO - fast_api_main/ Total time to fetch images: 0.0015437602996826172 seconds
2024-07-12 20:44:41,609 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:44:47,554 - INFO - fast_api_main/ Reviews for product 35GT14: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:44:47,554 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT15
2024-07-12 20:44:51,358 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:44:57,441 - INFO - fast_api_main/ Reviews for product 35GT14: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:44:57,442 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT15
2024-07-12 20:45:01,950 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:45:07,774 - INFO - fast_api_main/ Reviews for product 35GT15: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:45:07,774 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT13
2024-07-12 20:45:11,600 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:45:17,448 - INFO - fast_api_main/ Reviews for product 35GT15: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:45:17,448 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT13
2024-07-12 20:45:21,531 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:45:27,185 - INFO - fast_api_main/ Reviews for product 35GT13: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:45:27,185 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT12
2024-07-12 20:45:31,130 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:45:36,784 - INFO - fast_api_main/ Reviews for product 35GT13: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:45:36,784 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GT12
2024-07-12 20:45:42,336 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:45:48,136 - INFO - fast_api_main/ Reviews for product 35GT12: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:45:48,136 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GU61
2024-07-12 20:45:51,819 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:45:57,619 - INFO - fast_api_main/ Reviews for product 35GT12: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:45:57,619 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 35GU61
2024-07-12 20:46:01,596 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:46:07,578 - INFO - fast_api_main/ Reviews for product 35GU61: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:46:07,578 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 21A646
2024-07-12 20:46:11,328 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:46:17,025 - INFO - fast_api_main/ Reviews for product 35GU61: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:46:17,025 - INFO - fast_api_main/ Fetching reviews for product: These half rubber-dipped neoprene boots are flexible and form-fitting for a snug, secure fit. They have a waterproof rubber coating that covers the bottom half of the outside of the boot. Knee-height boots protect the foot, lower leg, and calf to just below the knee. These insulated boots are worn when users are exposed to cold, wet conditions and below-freezing temperatures., 21A646
2024-07-12 20:46:20,962 - WARNING - Connection pool is full, discarding connection: localhost. Connection pool size: 1
2024-07-12 20:46:26,597 - INFO - fast_api_main/ Reviews for product 21A646: {'Average Star Rating': 4.9, 'Average Recommendation Percent': 100.0, 'Review Texts': ['Excellent', 'Outstanding product for the price.  \nKeeps our guys comfortable, safe, and on the job.\n#sweepstakes', 'This is the best value boot for the price that you can buy. "Sweepstakes".', 'Great boots.', 'Great price and quality. Glad I found this website.']}
2024-07-12 20:46:26,597 - INFO - fast_api_main/ Total time taken for ask_question: 168.99891209602356 seconds
2024-07-12 20:46:26,598 - ERROR - Error in fast_api_main/ask_question: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
2024-07-12 20:46:26,600 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 123, in ask_question
    customer_attributes_retrieved=json.loads(customer_attributes_retrieved) if isinstance(
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)

Time for extract_customer_attributes: 2.3286149501800537
Time for split_process_and_message_from_response: 2.7179718017578125e-05
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT14 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT15 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT13 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GT12 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/35GT12_AW01?$lgmain$ for 35GU61 in 0.00 seconds
Fetched image URL https://static.grainger.com/rp/s/is/image/Grainger/21A644_AS01?$lgmain$ for 21A646 in 0.00 seconds
INFO:     127.0.0.1:49533 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
ERROR:root:Received None response_json from FastAPI
2024-07-12 20:46:33,199 - ERROR - Error fetching reviews: Message: 
Stacktrace:
0   chromedriver                        0x0000000100b52a80 chromedriver + 4385408
1   chromedriver                        0x0000000100b4b38c chromedriver + 4354956
2   chromedriver                        0x0000000100768b0c chromedriver + 281356
3   chromedriver                        0x00000001007ab2f8 chromedriver + 553720
4   chromedriver                        0x00000001007e3d24 chromedriver + 785700
5   chromedriver                        0x000000010079feec chromedriver + 507628
6   chromedriver                        0x00000001007a08c4 chromedriver + 510148
7   chromedriver                        0x0000000100b1a43c chromedriver + 4154428
8   chromedriver                        0x0000000100b1eea0 chromedriver + 4173472
9   chromedriver                        0x0000000100affff8 chromedriver + 4046840
10  chromedriver                        0x0000000100b1f78c chromedriver + 4175756
11  chromedriver                        0x0000000100af2fb8 chromedriver + 3993528
12  chromedriver                        0x0000000100b3d21c chromedriver + 4297244
13  chromedriver                        0x0000000100b3d398 chromedriver + 4297624
14  chromedriver                        0x0000000100b4af84 chromedriver + 4353924
15  libsystem_pthread.dylib             0x000000018095af94 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000180955d34 thread_start + 8

2024-07-12 20:46:33,202 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 198, in fetch_reviews
    reviews_data = await async_navigate_to_reviews_selenium(product_info, driver)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/product_reviews/call_selenium_for_review_async.py", line 64, in async_navigate_to_reviews_selenium
    await asyncio.to_thread(WebDriverWait(driver, 10).until, EC.presence_of_element_located((By.CSS_SELECTOR, 'a.product-card-image__link')))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/selenium/webdriver/support/wait.py", line 105, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 
Stacktrace:
0   chromedriver                        0x0000000100b52a80 chromedriver + 4385408
1   chromedriver                        0x0000000100b4b38c chromedriver + 4354956
2   chromedriver                        0x0000000100768b0c chromedriver + 281356
3   chromedriver                        0x00000001007ab2f8 chromedriver + 553720
4   chromedriver                        0x00000001007e3d24 chromedriver + 785700
5   chromedriver                        0x000000010079feec chromedriver + 507628
6   chromedriver                        0x00000001007a08c4 chromedriver + 510148
7   chromedriver                        0x0000000100b1a43c chromedriver + 4154428
8   chromedriver                        0x0000000100b1eea0 chromedriver + 4173472
9   chromedriver                        0x0000000100affff8 chromedriver + 4046840
10  chromedriver                        0x0000000100b1f78c chromedriver + 4175756
11  chromedriver                        0x0000000100af2fb8 chromedriver + 3993528
12  chromedriver                        0x0000000100b3d21c chromedriver + 4297244
13  chromedriver                        0x0000000100b3d398 chromedriver + 4297624
14  chromedriver                        0x0000000100b4af84 chromedriver + 4353924
15  libsystem_pthread.dylib             0x000000018095af94 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000180955d34 thread_start + 8


2024-07-12 20:46:33,202 - ERROR - Error in fast_api_main/ask_question: 500: Error fetching reviews
2024-07-12 20:46:33,203 - ERROR - Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 198, in fetch_reviews
    reviews_data = await async_navigate_to_reviews_selenium(product_info, driver)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/web_extraction_tools/product_reviews/call_selenium_for_review_async.py", line 64, in async_navigate_to_reviews_selenium
    await asyncio.to_thread(WebDriverWait(driver, 10).until, EC.presence_of_element_located((By.CSS_SELECTOR, 'a.product-card-image__link')))
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/anaconda3/envs/grainger_recommendations_chatbot-2/lib/python3.11/site-packages/selenium/webdriver/support/wait.py", line 105, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 
Stacktrace:
0   chromedriver                        0x0000000100b52a80 chromedriver + 4385408
1   chromedriver                        0x0000000100b4b38c chromedriver + 4354956
2   chromedriver                        0x0000000100768b0c chromedriver + 281356
3   chromedriver                        0x00000001007ab2f8 chromedriver + 553720
4   chromedriver                        0x00000001007e3d24 chromedriver + 785700
5   chromedriver                        0x000000010079feec chromedriver + 507628
6   chromedriver                        0x00000001007a08c4 chromedriver + 510148
7   chromedriver                        0x0000000100b1a43c chromedriver + 4154428
8   chromedriver                        0x0000000100b1eea0 chromedriver + 4173472
9   chromedriver                        0x0000000100affff8 chromedriver + 4046840
10  chromedriver                        0x0000000100b1f78c chromedriver + 4175756
11  chromedriver                        0x0000000100af2fb8 chromedriver + 3993528
12  chromedriver                        0x0000000100b3d21c chromedriver + 4297244
13  chromedriver                        0x0000000100b3d398 chromedriver + 4297624
14  chromedriver                        0x0000000100b4af84 chromedriver + 4353924
15  libsystem_pthread.dylib             0x000000018095af94 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000180955d34 thread_start + 8


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 107, in ask_question
    image_data, reviews_data = await asyncio.gather(
                               ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xnxn040/PycharmProjects/grainger_recommendations_chatbot/modules/fast_api_main.py", line 213, in fetch_reviews
    raise HTTPException(status_code=500, detail="Error fetching reviews")
fastapi.exceptions.HTTPException: 500: Error fetching reviews

ERROR:root:Failed to process chat question: {"detail":"Internal Server Error"}
INFO:     127.0.0.1:49556 - "POST /ask_question HTTP/1.1" 500 Internal Server Error
ERROR:root:Received None response_json from FastAPI
